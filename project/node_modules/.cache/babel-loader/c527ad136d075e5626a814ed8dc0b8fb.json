{"ast":null,"code":"import { DataUtil } from './util';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\r\n * Query class is used to build query which is used by the DataManager to communicate with datasource.\r\n */\n\nvar Query =\n/** @class */\nfunction () {\n  /**\r\n   * Constructor for Query class.\r\n   * @param  {string|string[]} from?\r\n   * @hidden\r\n   */\n  function Query(from) {\n    /** @hidden */\n    this.subQuery = null;\n    /** @hidden */\n\n    this.isChild = false;\n    /** @hidden */\n\n    this.distincts = [];\n    this.queries = [];\n    this.key = '';\n    this.fKey = '';\n\n    if (typeof from === 'string') {\n      this.fromTable = from;\n    } else if (from && from instanceof Array) {\n      this.lookups = from;\n    }\n\n    this.expands = [];\n    this.sortedColumns = [];\n    this.groupedColumns = [];\n    this.subQuery = null;\n    this.isChild = false;\n    this.params = [];\n    this.lazyLoad = [];\n    return this;\n  }\n  /**\r\n   * Sets the primary key.\r\n   * @param  {string} field - Defines the column field.\r\n   */\n\n\n  Query.prototype.setKey = function (field) {\n    this.key = field;\n    return this;\n  };\n  /**\r\n   * Sets default DataManager to execute query.\r\n   * @param  {DataManager} dataManager - Defines the DataManager.\r\n   */\n\n\n  Query.prototype.using = function (dataManager) {\n    this.dataManager = dataManager;\n    return this;\n  };\n  /**\r\n   * Executes query with the given DataManager.\r\n   * @param  {DataManager} dataManager - Defines the DataManager.\r\n   * @param  {Function} done - Defines the success callback.\r\n   * @param  {Function} fail - Defines the failure callback.\r\n   * @param  {Function} always - Defines the callback which will be invoked on either success or failure.\r\n   *\r\n   * <pre>\r\n   * let dataManager: DataManager = new DataManager([{ ID: '10' }, { ID: '2' }, { ID: '1' }, { ID: '20' }]);\r\n   * let query: Query = new Query();\r\n   * query.sortBy('ID', (x: string, y: string): number => { return parseInt(x, 10) - parseInt(y, 10) });\r\n   * let promise: Promise< Object > = query.execute(dataManager);\r\n   * promise.then((e: { result: Object }) => { });\r\n   * </pre>\r\n   */\n\n\n  Query.prototype.execute = function (dataManager, done, fail, always) {\n    dataManager = dataManager || this.dataManager;\n\n    if (dataManager) {\n      return dataManager.executeQuery(this, done, fail, always);\n    }\n\n    return DataUtil.throwError('Query - execute() : dataManager needs to be is set using \"using\" function or should be passed as argument');\n  };\n  /**\r\n   * Executes query with the local datasource.\r\n   * @param  {DataManager} dataManager - Defines the DataManager.\r\n   */\n\n\n  Query.prototype.executeLocal = function (dataManager) {\n    dataManager = dataManager || this.dataManager;\n\n    if (dataManager) {\n      return dataManager.executeLocal(this);\n    }\n\n    return DataUtil.throwError('Query - executeLocal() : dataManager needs to be is set using \"using\" function or should be passed as argument');\n  };\n  /**\r\n   * Creates deep copy of the Query object.\r\n   */\n\n\n  Query.prototype.clone = function () {\n    var cloned = new Query();\n    cloned.queries = this.queries.slice(0);\n    cloned.key = this.key;\n    cloned.isChild = this.isChild;\n    cloned.dataManager = this.dataManager;\n    cloned.fromTable = this.fromTable;\n    cloned.params = this.params.slice(0);\n    cloned.expands = this.expands.slice(0);\n    cloned.sortedColumns = this.sortedColumns.slice(0);\n    cloned.groupedColumns = this.groupedColumns.slice(0);\n    cloned.subQuerySelector = this.subQuerySelector;\n    cloned.subQuery = this.subQuery;\n    cloned.fKey = this.fKey;\n    cloned.isCountRequired = this.isCountRequired;\n    cloned.distincts = this.distincts.slice(0);\n    cloned.lazyLoad = this.lazyLoad.slice(0);\n    return cloned;\n  };\n  /**\r\n   * Specifies the name of table to retrieve data in query execution.\r\n   * @param  {string} tableName - Defines the table name.\r\n   */\n\n\n  Query.prototype.from = function (tableName) {\n    this.fromTable = tableName;\n    return this;\n  };\n  /**\r\n   * Adds additional parameter which will be sent along with the request which will be generated while DataManager execute.\r\n   * @param  {string} key - Defines the key of additional parameter.\r\n   * @param  {Function|string} value - Defines the value for the key.\r\n   */\n\n\n  Query.prototype.addParams = function (key, value) {\n    if (typeof value === 'function') {\n      this.params.push({\n        key: key,\n        fn: value\n      });\n    } else {\n      this.params.push({\n        key: key,\n        value: value\n      });\n    }\n\n    return this;\n  };\n  /**\r\n   * @hidden\r\n   */\n\n\n  Query.prototype.distinct = function (fields) {\n    if (typeof fields === 'string') {\n      this.distincts = [].slice.call([fields], 0);\n    } else {\n      this.distincts = fields.slice(0);\n    }\n\n    return this;\n  };\n  /**\r\n   * Expands the related table.\r\n   * @param  {string|Object[]} tables\r\n   */\n\n\n  Query.prototype.expand = function (tables) {\n    if (typeof tables === 'string') {\n      this.expands = [].slice.call([tables], 0);\n    } else {\n      this.expands = tables.slice(0);\n    }\n\n    return this;\n  };\n  /**\r\n   * Filter data with given filter criteria.\r\n   * @param  {string|Predicate} fieldName - Defines the column field or Predicate.\r\n   * @param  {string} operator - Defines the operator how to filter data.\r\n   * @param  {string|number|boolean} value - Defines the values to match with data.\r\n   * @param  {boolean} ignoreCase - If ignore case set to false, then filter data with exact match or else\r\n   * filter data with case insensitive.\r\n   */\n\n\n  Query.prototype.where = function (fieldName, operator, value, ignoreCase, ignoreAccent) {\n    operator = operator ? operator.toLowerCase() : null;\n    var predicate = null;\n\n    if (typeof fieldName === 'string') {\n      predicate = new Predicate(fieldName, operator, value, ignoreCase, ignoreAccent);\n    } else if (fieldName instanceof Predicate) {\n      predicate = fieldName;\n    }\n\n    this.queries.push({\n      fn: 'onWhere',\n      e: predicate\n    });\n    return this;\n  };\n  /**\r\n   * Search data with given search criteria.\r\n   * @param  {string|number|boolean} searchKey - Defines the search key.\r\n   * @param  {string|string[]} fieldNames - Defines the collection of column fields.\r\n   * @param  {string} operator - Defines the operator how to search data.\r\n   * @param  {boolean} ignoreCase - If ignore case set to false, then filter data with exact match or else\r\n   * filter data with case insensitive.\r\n   */\n\n\n  Query.prototype.search = function (searchKey, fieldNames, operator, ignoreCase, ignoreAccent) {\n    if (typeof fieldNames === 'string') {\n      fieldNames = [fieldNames];\n    }\n\n    if (!operator || operator === 'none') {\n      operator = 'contains';\n    }\n\n    var comparer = DataUtil.fnOperators[operator];\n    this.queries.push({\n      fn: 'onSearch',\n      e: {\n        fieldNames: fieldNames,\n        operator: operator,\n        searchKey: searchKey,\n        ignoreCase: ignoreCase,\n        ignoreAccent: ignoreAccent,\n        comparer: comparer\n      }\n    });\n    return this;\n  };\n  /**\r\n   * Sort the data with given sort criteria.\r\n   * By default, sort direction is ascending.\r\n   * @param  {string|string[]} fieldName - Defines the single or collection of column fields.\r\n   * @param  {string|Function} comparer - Defines the sort direction or custom sort comparer function.\r\n   */\n\n\n  Query.prototype.sortBy = function (fieldName, comparer, isFromGroup) {\n    return this.sortByForeignKey(fieldName, comparer, isFromGroup);\n  };\n  /**\r\n   * Sort the data with given sort criteria.\r\n   * By default, sort direction is ascending.\r\n   * @param  {string|string[]} fieldName - Defines the single or collection of column fields.\r\n   * @param  {string|Function} comparer - Defines the sort direction or custom sort comparer function.\r\n   * @param  {string} direction - Defines the sort direction .\r\n   */\n\n\n  Query.prototype.sortByForeignKey = function (fieldName, comparer, isFromGroup, direction) {\n    var order = !isNullOrUndefined(direction) ? direction : 'ascending';\n    var sorts;\n    var temp;\n\n    if (typeof fieldName === 'string' && DataUtil.endsWith(fieldName.toLowerCase(), ' desc')) {\n      fieldName = fieldName.replace(/ desc$/i, '');\n      comparer = 'descending';\n    }\n\n    if (!comparer || typeof comparer === 'string') {\n      order = comparer ? comparer.toLowerCase() : 'ascending';\n      comparer = DataUtil.fnSort(comparer);\n    }\n\n    if (isFromGroup) {\n      sorts = Query.filterQueries(this.queries, 'onSortBy');\n\n      for (var i = 0; i < sorts.length; i++) {\n        temp = sorts[i].e.fieldName;\n\n        if (typeof temp === 'string') {\n          if (temp === fieldName) {\n            return this;\n          }\n        } else if (temp instanceof Array) {\n          for (var j = 0; j < temp.length; j++) {\n            if (temp[j] === fieldName || fieldName.toLowerCase() === temp[j] + ' desc') {\n              return this;\n            }\n          }\n        }\n      }\n    }\n\n    this.queries.push({\n      fn: 'onSortBy',\n      e: {\n        fieldName: fieldName,\n        comparer: comparer,\n        direction: order\n      }\n    });\n    return this;\n  };\n  /**\r\n   * Sorts data in descending order.\r\n   * @param  {string} fieldName - Defines the column field.\r\n   */\n\n\n  Query.prototype.sortByDesc = function (fieldName) {\n    return this.sortBy(fieldName, 'descending');\n  };\n  /**\r\n   * Groups data with the given field name.\r\n   * @param  {string} fieldName - Defines the column field.\r\n   */\n\n\n  Query.prototype.group = function (fieldName, fn, format) {\n    this.sortBy(fieldName, null, true);\n    this.queries.push({\n      fn: 'onGroup',\n      e: {\n        fieldName: fieldName,\n        comparer: fn ? fn : null,\n        format: format ? format : null\n      }\n    });\n    return this;\n  };\n  /**\r\n   * Gets data based on the given page index and size.\r\n   * @param  {number} pageIndex - Defines the current page index.\r\n   * @param  {number} pageSize - Defines the no of records per page.\r\n   */\n\n\n  Query.prototype.page = function (pageIndex, pageSize) {\n    this.queries.push({\n      fn: 'onPage',\n      e: {\n        pageIndex: pageIndex,\n        pageSize: pageSize\n      }\n    });\n    return this;\n  };\n  /**\r\n   * Gets data based on the given start and end index.\r\n   * @param  {number} start - Defines the start index of the datasource.\r\n   * @param  {number} end - Defines the end index of the datasource.\r\n   */\n\n\n  Query.prototype.range = function (start, end) {\n    this.queries.push({\n      fn: 'onRange',\n      e: {\n        start: start,\n        end: end\n      }\n    });\n    return this;\n  };\n  /**\r\n   * Gets data from the top of the data source based on given number of records count.\r\n   * @param  {number} nos - Defines the no of records to retrieve from datasource.\r\n   */\n\n\n  Query.prototype.take = function (nos) {\n    this.queries.push({\n      fn: 'onTake',\n      e: {\n        nos: nos\n      }\n    });\n    return this;\n  };\n  /**\r\n   * Skips data with given number of records count from the top of the data source.\r\n   * @param  {number} nos - Defines the no of records skip in the datasource.\r\n   */\n\n\n  Query.prototype.skip = function (nos) {\n    this.queries.push({\n      fn: 'onSkip',\n      e: {\n        nos: nos\n      }\n    });\n    return this;\n  };\n  /**\r\n   * Selects specified columns from the data source.\r\n   * @param  {string|string[]} fieldNames - Defines the collection of column fields.\r\n   */\n\n\n  Query.prototype.select = function (fieldNames) {\n    if (typeof fieldNames === 'string') {\n      fieldNames = [].slice.call([fieldNames], 0);\n    }\n\n    this.queries.push({\n      fn: 'onSelect',\n      e: {\n        fieldNames: fieldNames\n      }\n    });\n    return this;\n  };\n  /**\r\n   * Gets the records in hierarchical relationship from two tables. It requires the foreign key to relate two tables.\r\n   * @param  {Query} query - Defines the query to relate two tables.\r\n   * @param  {Function} selectorFn - Defines the custom function to select records.\r\n   */\n\n\n  Query.prototype.hierarchy = function (query, selectorFn) {\n    this.subQuerySelector = selectorFn;\n    this.subQuery = query;\n    return this;\n  };\n  /**\r\n   * Sets the foreign key which is used to get data from the related table.\r\n   * @param  {string} key - Defines the foreign key.\r\n   */\n\n\n  Query.prototype.foreignKey = function (key) {\n    this.fKey = key;\n    return this;\n  };\n  /**\r\n   * It is used to get total number of records in the DataManager execution result.\r\n   */\n\n\n  Query.prototype.requiresCount = function () {\n    this.isCountRequired = true;\n    return this;\n  }; //type - sum, avg, min, max\n\n  /**\r\n   * Aggregate the data with given type and field name.\r\n   * @param  {string} type - Defines the aggregate type.\r\n   * @param  {string} field - Defines the column field to aggregate.\r\n   */\n\n\n  Query.prototype.aggregate = function (type, field) {\n    this.queries.push({\n      fn: 'onAggregates',\n      e: {\n        field: field,\n        type: type\n      }\n    });\n    return this;\n  };\n  /**\r\n   * Pass array of filterColumn query for performing filter operation.\r\n   * @param  {QueryOptions[]} queries\r\n   * @param  {string} name\r\n   * @hidden\r\n   */\n\n\n  Query.filterQueries = function (queries, name) {\n    return queries.filter(function (q) {\n      return q.fn === name;\n    });\n  };\n  /**\r\n   * To get the list of queries which is already filtered in current data source.\r\n   * @param  {Object[]} queries\r\n   * @param  {string[]} singles\r\n   * @hidden\r\n   */\n\n\n  Query.filterQueryLists = function (queries, singles) {\n    var filtered = queries.filter(function (q) {\n      return singles.indexOf(q.fn) !== -1;\n    });\n    var res = {};\n\n    for (var i = 0; i < filtered.length; i++) {\n      if (!res[filtered[i].fn]) {\n        res[filtered[i].fn] = filtered[i].e;\n      }\n    }\n\n    return res;\n  };\n\n  return Query;\n}();\n\nexport { Query };\n/**\r\n * Predicate class is used to generate complex filter criteria.\r\n * This will be used by DataManager to perform multiple filtering operation.\r\n */\n\nvar Predicate =\n/** @class */\nfunction () {\n  /**\r\n   * Constructor for Predicate class.\r\n   * @param  {string|Predicate} field\r\n   * @param  {string} operator\r\n   * @param  {string|number|boolean|Predicate|Predicate[]} value\r\n   * @param  {boolean=false} ignoreCase\r\n   * @hidden\r\n   */\n  function Predicate(field, operator, value, ignoreCase, ignoreAccent) {\n    if (ignoreCase === void 0) {\n      ignoreCase = false;\n    }\n    /** @hidden */\n\n\n    this.ignoreAccent = false;\n    /** @hidden */\n\n    this.isComplex = false;\n\n    if (typeof field === 'string') {\n      this.field = field;\n      this.operator = operator.toLowerCase();\n      this.value = value;\n      this.ignoreCase = ignoreCase;\n      this.ignoreAccent = ignoreAccent;\n      this.isComplex = false;\n      this.comparer = DataUtil.fnOperators.processOperator(this.operator);\n    } else if (field instanceof Predicate && value instanceof Predicate || value instanceof Array) {\n      this.isComplex = true;\n      this.condition = operator.toLowerCase();\n      this.predicates = [field];\n\n      if (value instanceof Array) {\n        [].push.apply(this.predicates, value);\n      } else {\n        this.predicates.push(value);\n      }\n    }\n\n    return this;\n  }\n  /**\r\n   * Adds n-number of new predicates on existing predicate with “and” condition.\r\n   * @param  {Object[]} args - Defines the collection of predicates.\r\n   */\n\n\n  Predicate.and = function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    return Predicate.combinePredicates([].slice.call(args, 0), 'and');\n  };\n  /**\r\n   * Adds new predicate on existing predicate with “and” condition.\r\n   * @param  {string} field - Defines the column field.\r\n   * @param  {string} operator - Defines the operator how to filter data.\r\n   * @param  {string} value - Defines the values to match with data.\r\n   * @param  {boolean} ignoreCase? - If ignore case set to false, then filter data with exact match or else\r\n   * filter data with case insensitive.\r\n   */\n\n\n  Predicate.prototype.and = function (field, operator, value, ignoreCase, ignoreAccent) {\n    return Predicate.combine(this, field, operator, value, 'and', ignoreCase, ignoreAccent);\n  };\n  /**\r\n   * Adds n-number of new predicates on existing predicate with “or” condition.\r\n   * @param  {Object[]} args - Defines the collection of predicates.\r\n   */\n\n\n  Predicate.or = function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    return Predicate.combinePredicates([].slice.call(args, 0), 'or');\n  };\n  /**\r\n   * Adds new predicate on existing predicate with “or” condition.\r\n   * @param  {string} field - Defines the column field.\r\n   * @param  {string} operator - Defines the operator how to filter data.\r\n   * @param  {string} value - Defines the values to match with data.\r\n   * @param  {boolean} ignoreCase? - If ignore case set to false, then filter data with exact match or else\r\n   * filter data with case insensitive.\r\n   */\n\n\n  Predicate.prototype.or = function (field, operator, value, ignoreCase, ignoreAccent) {\n    return Predicate.combine(this, field, operator, value, 'or', ignoreCase, ignoreAccent);\n  };\n  /**\r\n   * Converts plain JavaScript object to Predicate object.\r\n   * @param  {Predicate[]|Predicate} json - Defines single or collection of Predicate.\r\n   */\n\n\n  Predicate.fromJson = function (json) {\n    if (json instanceof Array) {\n      var res = [];\n\n      for (var i = 0, len = json.length; i < len; i++) {\n        res.push(this.fromJSONData(json[i]));\n      }\n\n      return res;\n    }\n\n    var pred = json;\n    return this.fromJSONData(pred);\n  };\n  /**\r\n   * Validate the record based on the predicates.\r\n   * @param  {Object} record - Defines the datasource record.\r\n   */\n\n\n  Predicate.prototype.validate = function (record) {\n    var predicate = this.predicates ? this.predicates : [];\n    var isAnd;\n    var ret;\n\n    if (!this.isComplex && this.comparer) {\n      return this.comparer.call(this, DataUtil.getObject(this.field, record), this.value, this.ignoreCase, this.ignoreAccent);\n    }\n\n    isAnd = this.condition === 'and';\n\n    for (var i = 0; i < predicate.length; i++) {\n      ret = predicate[i].validate(record);\n\n      if (isAnd) {\n        if (!ret) {\n          return false;\n        }\n      } else {\n        if (ret) {\n          return true;\n        }\n      }\n    }\n\n    return isAnd;\n  };\n  /**\r\n   * Converts predicates to plain JavaScript.\r\n   * This method is uses Json stringify when serializing Predicate object.\r\n   */\n\n\n  Predicate.prototype.toJson = function () {\n    var predicates;\n    var p;\n\n    if (this.isComplex) {\n      predicates = [];\n      p = this.predicates;\n\n      for (var i = 0; i < p.length; i++) {\n        predicates.push(p[i].toJson());\n      }\n    }\n\n    return {\n      isComplex: this.isComplex,\n      field: this.field,\n      operator: this.operator,\n      value: this.value,\n      ignoreCase: this.ignoreCase,\n      ignoreAccent: this.ignoreAccent,\n      condition: this.condition,\n      predicates: predicates\n    };\n  };\n\n  Predicate.combinePredicates = function (predicates, operator) {\n    if (predicates.length === 1) {\n      if (!(predicates[0] instanceof Array)) {\n        return predicates[0];\n      }\n\n      predicates = predicates[0];\n    }\n\n    return new Predicate(predicates[0], operator, predicates.slice(1));\n  };\n\n  Predicate.combine = function (pred, field, operator, value, condition, ignoreCase, ignoreAccent) {\n    if (field instanceof Predicate) {\n      return Predicate[condition](pred, field);\n    }\n\n    if (typeof field === 'string') {\n      return Predicate[condition](pred, new Predicate(field, operator, value, ignoreCase, ignoreAccent));\n    }\n\n    return DataUtil.throwError('Predicate - ' + condition + ' : invalid arguments');\n  };\n\n  Predicate.fromJSONData = function (json) {\n    var preds = json.predicates || [];\n    var len = preds.length;\n    var predicates = [];\n    var result;\n\n    for (var i = 0; i < len; i++) {\n      predicates.push(this.fromJSONData(preds[i]));\n    }\n\n    if (!json.isComplex) {\n      result = new Predicate(json.field, json.operator, json.value, json.ignoreCase, json.ignoreAccent);\n    } else {\n      result = new Predicate(predicates[0], json.condition, predicates.slice(1));\n    }\n\n    return result;\n  };\n\n  return Predicate;\n}();\n\nexport { Predicate };","map":{"version":3,"sources":["C:/Users/x/Desktop/openDSA/openDSA_dashboard/project/node_modules/@syncfusion/ej2-data/src/query.js"],"names":["DataUtil","isNullOrUndefined","Query","from","subQuery","isChild","distincts","queries","key","fKey","fromTable","Array","lookups","expands","sortedColumns","groupedColumns","params","lazyLoad","prototype","setKey","field","using","dataManager","execute","done","fail","always","executeQuery","throwError","executeLocal","clone","cloned","slice","subQuerySelector","isCountRequired","tableName","addParams","value","push","fn","distinct","fields","call","expand","tables","where","fieldName","operator","ignoreCase","ignoreAccent","toLowerCase","predicate","Predicate","e","search","searchKey","fieldNames","comparer","fnOperators","sortBy","isFromGroup","sortByForeignKey","direction","order","sorts","temp","endsWith","replace","fnSort","filterQueries","i","length","j","sortByDesc","group","format","page","pageIndex","pageSize","range","start","end","take","nos","skip","select","hierarchy","query","selectorFn","foreignKey","requiresCount","aggregate","type","name","filter","q","filterQueryLists","singles","filtered","indexOf","res","isComplex","processOperator","condition","predicates","apply","and","args","_i","arguments","combinePredicates","combine","or","fromJson","json","len","fromJSONData","pred","validate","record","isAnd","ret","getObject","toJson","p","preds","result"],"mappings":"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","sourcesContent":["import { DataUtil } from './util';\r\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\r\n/**\r\n * Query class is used to build query which is used by the DataManager to communicate with datasource.\r\n */\r\nvar Query = /** @class */ (function () {\r\n    /**\r\n     * Constructor for Query class.\r\n     * @param  {string|string[]} from?\r\n     * @hidden\r\n     */\r\n    function Query(from) {\r\n        /** @hidden */\r\n        this.subQuery = null;\r\n        /** @hidden */\r\n        this.isChild = false;\r\n        /** @hidden */\r\n        this.distincts = [];\r\n        this.queries = [];\r\n        this.key = '';\r\n        this.fKey = '';\r\n        if (typeof from === 'string') {\r\n            this.fromTable = from;\r\n        }\r\n        else if (from && from instanceof Array) {\r\n            this.lookups = from;\r\n        }\r\n        this.expands = [];\r\n        this.sortedColumns = [];\r\n        this.groupedColumns = [];\r\n        this.subQuery = null;\r\n        this.isChild = false;\r\n        this.params = [];\r\n        this.lazyLoad = [];\r\n        return this;\r\n    }\r\n    /**\r\n     * Sets the primary key.\r\n     * @param  {string} field - Defines the column field.\r\n     */\r\n    Query.prototype.setKey = function (field) {\r\n        this.key = field;\r\n        return this;\r\n    };\r\n    /**\r\n     * Sets default DataManager to execute query.\r\n     * @param  {DataManager} dataManager - Defines the DataManager.\r\n     */\r\n    Query.prototype.using = function (dataManager) {\r\n        this.dataManager = dataManager;\r\n        return this;\r\n    };\r\n    /**\r\n     * Executes query with the given DataManager.\r\n     * @param  {DataManager} dataManager - Defines the DataManager.\r\n     * @param  {Function} done - Defines the success callback.\r\n     * @param  {Function} fail - Defines the failure callback.\r\n     * @param  {Function} always - Defines the callback which will be invoked on either success or failure.\r\n     *\r\n     * <pre>\r\n     * let dataManager: DataManager = new DataManager([{ ID: '10' }, { ID: '2' }, { ID: '1' }, { ID: '20' }]);\r\n     * let query: Query = new Query();\r\n     * query.sortBy('ID', (x: string, y: string): number => { return parseInt(x, 10) - parseInt(y, 10) });\r\n     * let promise: Promise< Object > = query.execute(dataManager);\r\n     * promise.then((e: { result: Object }) => { });\r\n     * </pre>\r\n     */\r\n    Query.prototype.execute = function (dataManager, done, fail, always) {\r\n        dataManager = dataManager || this.dataManager;\r\n        if (dataManager) {\r\n            return dataManager.executeQuery(this, done, fail, always);\r\n        }\r\n        return DataUtil.throwError('Query - execute() : dataManager needs to be is set using \"using\" function or should be passed as argument');\r\n    };\r\n    /**\r\n     * Executes query with the local datasource.\r\n     * @param  {DataManager} dataManager - Defines the DataManager.\r\n     */\r\n    Query.prototype.executeLocal = function (dataManager) {\r\n        dataManager = dataManager || this.dataManager;\r\n        if (dataManager) {\r\n            return dataManager.executeLocal(this);\r\n        }\r\n        return DataUtil.throwError('Query - executeLocal() : dataManager needs to be is set using \"using\" function or should be passed as argument');\r\n    };\r\n    /**\r\n     * Creates deep copy of the Query object.\r\n     */\r\n    Query.prototype.clone = function () {\r\n        var cloned = new Query();\r\n        cloned.queries = this.queries.slice(0);\r\n        cloned.key = this.key;\r\n        cloned.isChild = this.isChild;\r\n        cloned.dataManager = this.dataManager;\r\n        cloned.fromTable = this.fromTable;\r\n        cloned.params = this.params.slice(0);\r\n        cloned.expands = this.expands.slice(0);\r\n        cloned.sortedColumns = this.sortedColumns.slice(0);\r\n        cloned.groupedColumns = this.groupedColumns.slice(0);\r\n        cloned.subQuerySelector = this.subQuerySelector;\r\n        cloned.subQuery = this.subQuery;\r\n        cloned.fKey = this.fKey;\r\n        cloned.isCountRequired = this.isCountRequired;\r\n        cloned.distincts = this.distincts.slice(0);\r\n        cloned.lazyLoad = this.lazyLoad.slice(0);\r\n        return cloned;\r\n    };\r\n    /**\r\n     * Specifies the name of table to retrieve data in query execution.\r\n     * @param  {string} tableName - Defines the table name.\r\n     */\r\n    Query.prototype.from = function (tableName) {\r\n        this.fromTable = tableName;\r\n        return this;\r\n    };\r\n    /**\r\n     * Adds additional parameter which will be sent along with the request which will be generated while DataManager execute.\r\n     * @param  {string} key - Defines the key of additional parameter.\r\n     * @param  {Function|string} value - Defines the value for the key.\r\n     */\r\n    Query.prototype.addParams = function (key, value) {\r\n        if (typeof value === 'function') {\r\n            this.params.push({ key: key, fn: value });\r\n        }\r\n        else {\r\n            this.params.push({ key: key, value: value });\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    Query.prototype.distinct = function (fields) {\r\n        if (typeof fields === 'string') {\r\n            this.distincts = [].slice.call([fields], 0);\r\n        }\r\n        else {\r\n            this.distincts = fields.slice(0);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * Expands the related table.\r\n     * @param  {string|Object[]} tables\r\n     */\r\n    Query.prototype.expand = function (tables) {\r\n        if (typeof tables === 'string') {\r\n            this.expands = [].slice.call([tables], 0);\r\n        }\r\n        else {\r\n            this.expands = tables.slice(0);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * Filter data with given filter criteria.\r\n     * @param  {string|Predicate} fieldName - Defines the column field or Predicate.\r\n     * @param  {string} operator - Defines the operator how to filter data.\r\n     * @param  {string|number|boolean} value - Defines the values to match with data.\r\n     * @param  {boolean} ignoreCase - If ignore case set to false, then filter data with exact match or else\r\n     * filter data with case insensitive.\r\n     */\r\n    Query.prototype.where = function (fieldName, operator, value, ignoreCase, ignoreAccent) {\r\n        operator = operator ? (operator).toLowerCase() : null;\r\n        var predicate = null;\r\n        if (typeof fieldName === 'string') {\r\n            predicate = new Predicate(fieldName, operator, value, ignoreCase, ignoreAccent);\r\n        }\r\n        else if (fieldName instanceof Predicate) {\r\n            predicate = fieldName;\r\n        }\r\n        this.queries.push({\r\n            fn: 'onWhere',\r\n            e: predicate\r\n        });\r\n        return this;\r\n    };\r\n    /**\r\n     * Search data with given search criteria.\r\n     * @param  {string|number|boolean} searchKey - Defines the search key.\r\n     * @param  {string|string[]} fieldNames - Defines the collection of column fields.\r\n     * @param  {string} operator - Defines the operator how to search data.\r\n     * @param  {boolean} ignoreCase - If ignore case set to false, then filter data with exact match or else\r\n     * filter data with case insensitive.\r\n     */\r\n    Query.prototype.search = function (searchKey, fieldNames, operator, ignoreCase, ignoreAccent) {\r\n        if (typeof fieldNames === 'string') {\r\n            fieldNames = [fieldNames];\r\n        }\r\n        if (!operator || operator === 'none') {\r\n            operator = 'contains';\r\n        }\r\n        var comparer = DataUtil.fnOperators[operator];\r\n        this.queries.push({\r\n            fn: 'onSearch',\r\n            e: {\r\n                fieldNames: fieldNames,\r\n                operator: operator,\r\n                searchKey: searchKey,\r\n                ignoreCase: ignoreCase,\r\n                ignoreAccent: ignoreAccent,\r\n                comparer: comparer\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    /**\r\n     * Sort the data with given sort criteria.\r\n     * By default, sort direction is ascending.\r\n     * @param  {string|string[]} fieldName - Defines the single or collection of column fields.\r\n     * @param  {string|Function} comparer - Defines the sort direction or custom sort comparer function.\r\n     */\r\n    Query.prototype.sortBy = function (fieldName, comparer, isFromGroup) {\r\n        return this.sortByForeignKey(fieldName, comparer, isFromGroup);\r\n    };\r\n    /**\r\n     * Sort the data with given sort criteria.\r\n     * By default, sort direction is ascending.\r\n     * @param  {string|string[]} fieldName - Defines the single or collection of column fields.\r\n     * @param  {string|Function} comparer - Defines the sort direction or custom sort comparer function.\r\n     * @param  {string} direction - Defines the sort direction .\r\n     */\r\n    Query.prototype.sortByForeignKey = function (fieldName, comparer, isFromGroup, direction) {\r\n        var order = !isNullOrUndefined(direction) ? direction : 'ascending';\r\n        var sorts;\r\n        var temp;\r\n        if (typeof fieldName === 'string' && DataUtil.endsWith(fieldName.toLowerCase(), ' desc')) {\r\n            fieldName = fieldName.replace(/ desc$/i, '');\r\n            comparer = 'descending';\r\n        }\r\n        if (!comparer || typeof comparer === 'string') {\r\n            order = comparer ? comparer.toLowerCase() : 'ascending';\r\n            comparer = DataUtil.fnSort(comparer);\r\n        }\r\n        if (isFromGroup) {\r\n            sorts = Query.filterQueries(this.queries, 'onSortBy');\r\n            for (var i = 0; i < sorts.length; i++) {\r\n                temp = sorts[i].e.fieldName;\r\n                if (typeof temp === 'string') {\r\n                    if (temp === fieldName) {\r\n                        return this;\r\n                    }\r\n                }\r\n                else if (temp instanceof Array) {\r\n                    for (var j = 0; j < temp.length; j++) {\r\n                        if (temp[j] === fieldName || fieldName.toLowerCase() === temp[j] + ' desc') {\r\n                            return this;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.queries.push({\r\n            fn: 'onSortBy',\r\n            e: {\r\n                fieldName: fieldName,\r\n                comparer: comparer,\r\n                direction: order\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    /**\r\n     * Sorts data in descending order.\r\n     * @param  {string} fieldName - Defines the column field.\r\n     */\r\n    Query.prototype.sortByDesc = function (fieldName) {\r\n        return this.sortBy(fieldName, 'descending');\r\n    };\r\n    /**\r\n     * Groups data with the given field name.\r\n     * @param  {string} fieldName - Defines the column field.\r\n     */\r\n    Query.prototype.group = function (fieldName, fn, format) {\r\n        this.sortBy(fieldName, null, true);\r\n        this.queries.push({\r\n            fn: 'onGroup',\r\n            e: {\r\n                fieldName: fieldName,\r\n                comparer: fn ? fn : null,\r\n                format: format ? format : null\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    /**\r\n     * Gets data based on the given page index and size.\r\n     * @param  {number} pageIndex - Defines the current page index.\r\n     * @param  {number} pageSize - Defines the no of records per page.\r\n     */\r\n    Query.prototype.page = function (pageIndex, pageSize) {\r\n        this.queries.push({\r\n            fn: 'onPage',\r\n            e: {\r\n                pageIndex: pageIndex,\r\n                pageSize: pageSize\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    /**\r\n     * Gets data based on the given start and end index.\r\n     * @param  {number} start - Defines the start index of the datasource.\r\n     * @param  {number} end - Defines the end index of the datasource.\r\n     */\r\n    Query.prototype.range = function (start, end) {\r\n        this.queries.push({\r\n            fn: 'onRange',\r\n            e: {\r\n                start: start,\r\n                end: end\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    /**\r\n     * Gets data from the top of the data source based on given number of records count.\r\n     * @param  {number} nos - Defines the no of records to retrieve from datasource.\r\n     */\r\n    Query.prototype.take = function (nos) {\r\n        this.queries.push({\r\n            fn: 'onTake',\r\n            e: {\r\n                nos: nos\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    /**\r\n     * Skips data with given number of records count from the top of the data source.\r\n     * @param  {number} nos - Defines the no of records skip in the datasource.\r\n     */\r\n    Query.prototype.skip = function (nos) {\r\n        this.queries.push({\r\n            fn: 'onSkip',\r\n            e: { nos: nos }\r\n        });\r\n        return this;\r\n    };\r\n    /**\r\n     * Selects specified columns from the data source.\r\n     * @param  {string|string[]} fieldNames - Defines the collection of column fields.\r\n     */\r\n    Query.prototype.select = function (fieldNames) {\r\n        if (typeof fieldNames === 'string') {\r\n            fieldNames = [].slice.call([fieldNames], 0);\r\n        }\r\n        this.queries.push({\r\n            fn: 'onSelect',\r\n            e: { fieldNames: fieldNames }\r\n        });\r\n        return this;\r\n    };\r\n    /**\r\n     * Gets the records in hierarchical relationship from two tables. It requires the foreign key to relate two tables.\r\n     * @param  {Query} query - Defines the query to relate two tables.\r\n     * @param  {Function} selectorFn - Defines the custom function to select records.\r\n     */\r\n    Query.prototype.hierarchy = function (query, selectorFn) {\r\n        this.subQuerySelector = selectorFn;\r\n        this.subQuery = query;\r\n        return this;\r\n    };\r\n    /**\r\n     * Sets the foreign key which is used to get data from the related table.\r\n     * @param  {string} key - Defines the foreign key.\r\n     */\r\n    Query.prototype.foreignKey = function (key) {\r\n        this.fKey = key;\r\n        return this;\r\n    };\r\n    /**\r\n     * It is used to get total number of records in the DataManager execution result.\r\n     */\r\n    Query.prototype.requiresCount = function () {\r\n        this.isCountRequired = true;\r\n        return this;\r\n    };\r\n    //type - sum, avg, min, max\r\n    /**\r\n     * Aggregate the data with given type and field name.\r\n     * @param  {string} type - Defines the aggregate type.\r\n     * @param  {string} field - Defines the column field to aggregate.\r\n     */\r\n    Query.prototype.aggregate = function (type, field) {\r\n        this.queries.push({\r\n            fn: 'onAggregates',\r\n            e: { field: field, type: type }\r\n        });\r\n        return this;\r\n    };\r\n    /**\r\n     * Pass array of filterColumn query for performing filter operation.\r\n     * @param  {QueryOptions[]} queries\r\n     * @param  {string} name\r\n     * @hidden\r\n     */\r\n    Query.filterQueries = function (queries, name) {\r\n        return queries.filter(function (q) {\r\n            return q.fn === name;\r\n        });\r\n    };\r\n    /**\r\n     * To get the list of queries which is already filtered in current data source.\r\n     * @param  {Object[]} queries\r\n     * @param  {string[]} singles\r\n     * @hidden\r\n     */\r\n    Query.filterQueryLists = function (queries, singles) {\r\n        var filtered = queries.filter(function (q) {\r\n            return singles.indexOf(q.fn) !== -1;\r\n        });\r\n        var res = {};\r\n        for (var i = 0; i < filtered.length; i++) {\r\n            if (!res[filtered[i].fn]) {\r\n                res[filtered[i].fn] = filtered[i].e;\r\n            }\r\n        }\r\n        return res;\r\n    };\r\n    return Query;\r\n}());\r\nexport { Query };\r\n/**\r\n * Predicate class is used to generate complex filter criteria.\r\n * This will be used by DataManager to perform multiple filtering operation.\r\n */\r\nvar Predicate = /** @class */ (function () {\r\n    /**\r\n     * Constructor for Predicate class.\r\n     * @param  {string|Predicate} field\r\n     * @param  {string} operator\r\n     * @param  {string|number|boolean|Predicate|Predicate[]} value\r\n     * @param  {boolean=false} ignoreCase\r\n     * @hidden\r\n     */\r\n    function Predicate(field, operator, value, ignoreCase, ignoreAccent) {\r\n        if (ignoreCase === void 0) { ignoreCase = false; }\r\n        /** @hidden */\r\n        this.ignoreAccent = false;\r\n        /** @hidden */\r\n        this.isComplex = false;\r\n        if (typeof field === 'string') {\r\n            this.field = field;\r\n            this.operator = operator.toLowerCase();\r\n            this.value = value;\r\n            this.ignoreCase = ignoreCase;\r\n            this.ignoreAccent = ignoreAccent;\r\n            this.isComplex = false;\r\n            this.comparer = DataUtil.fnOperators.processOperator(this.operator);\r\n        }\r\n        else if (field instanceof Predicate && value instanceof Predicate || value instanceof Array) {\r\n            this.isComplex = true;\r\n            this.condition = operator.toLowerCase();\r\n            this.predicates = [field];\r\n            if (value instanceof Array) {\r\n                [].push.apply(this.predicates, value);\r\n            }\r\n            else {\r\n                this.predicates.push(value);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Adds n-number of new predicates on existing predicate with “and” condition.\r\n     * @param  {Object[]} args - Defines the collection of predicates.\r\n     */\r\n    Predicate.and = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        return Predicate.combinePredicates([].slice.call(args, 0), 'and');\r\n    };\r\n    /**\r\n     * Adds new predicate on existing predicate with “and” condition.\r\n     * @param  {string} field - Defines the column field.\r\n     * @param  {string} operator - Defines the operator how to filter data.\r\n     * @param  {string} value - Defines the values to match with data.\r\n     * @param  {boolean} ignoreCase? - If ignore case set to false, then filter data with exact match or else\r\n     * filter data with case insensitive.\r\n     */\r\n    Predicate.prototype.and = function (field, operator, value, ignoreCase, ignoreAccent) {\r\n        return Predicate.combine(this, field, operator, value, 'and', ignoreCase, ignoreAccent);\r\n    };\r\n    /**\r\n     * Adds n-number of new predicates on existing predicate with “or” condition.\r\n     * @param  {Object[]} args - Defines the collection of predicates.\r\n     */\r\n    Predicate.or = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        return Predicate.combinePredicates([].slice.call(args, 0), 'or');\r\n    };\r\n    /**\r\n     * Adds new predicate on existing predicate with “or” condition.\r\n     * @param  {string} field - Defines the column field.\r\n     * @param  {string} operator - Defines the operator how to filter data.\r\n     * @param  {string} value - Defines the values to match with data.\r\n     * @param  {boolean} ignoreCase? - If ignore case set to false, then filter data with exact match or else\r\n     * filter data with case insensitive.\r\n     */\r\n    Predicate.prototype.or = function (field, operator, value, ignoreCase, ignoreAccent) {\r\n        return Predicate.combine(this, field, operator, value, 'or', ignoreCase, ignoreAccent);\r\n    };\r\n    /**\r\n     * Converts plain JavaScript object to Predicate object.\r\n     * @param  {Predicate[]|Predicate} json - Defines single or collection of Predicate.\r\n     */\r\n    Predicate.fromJson = function (json) {\r\n        if (json instanceof Array) {\r\n            var res = [];\r\n            for (var i = 0, len = json.length; i < len; i++) {\r\n                res.push(this.fromJSONData(json[i]));\r\n            }\r\n            return res;\r\n        }\r\n        var pred = json;\r\n        return this.fromJSONData(pred);\r\n    };\r\n    /**\r\n     * Validate the record based on the predicates.\r\n     * @param  {Object} record - Defines the datasource record.\r\n     */\r\n    Predicate.prototype.validate = function (record) {\r\n        var predicate = this.predicates ? this.predicates : [];\r\n        var isAnd;\r\n        var ret;\r\n        if (!this.isComplex && this.comparer) {\r\n            return this.comparer.call(this, DataUtil.getObject(this.field, record), this.value, this.ignoreCase, this.ignoreAccent);\r\n        }\r\n        isAnd = this.condition === 'and';\r\n        for (var i = 0; i < predicate.length; i++) {\r\n            ret = predicate[i].validate(record);\r\n            if (isAnd) {\r\n                if (!ret) {\r\n                    return false;\r\n                }\r\n            }\r\n            else {\r\n                if (ret) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return isAnd;\r\n    };\r\n    /**\r\n     * Converts predicates to plain JavaScript.\r\n     * This method is uses Json stringify when serializing Predicate object.\r\n     */\r\n    Predicate.prototype.toJson = function () {\r\n        var predicates;\r\n        var p;\r\n        if (this.isComplex) {\r\n            predicates = [];\r\n            p = this.predicates;\r\n            for (var i = 0; i < p.length; i++) {\r\n                predicates.push(p[i].toJson());\r\n            }\r\n        }\r\n        return {\r\n            isComplex: this.isComplex,\r\n            field: this.field,\r\n            operator: this.operator,\r\n            value: this.value,\r\n            ignoreCase: this.ignoreCase,\r\n            ignoreAccent: this.ignoreAccent,\r\n            condition: this.condition,\r\n            predicates: predicates\r\n        };\r\n    };\r\n    Predicate.combinePredicates = function (predicates, operator) {\r\n        if (predicates.length === 1) {\r\n            if (!(predicates[0] instanceof Array)) {\r\n                return predicates[0];\r\n            }\r\n            predicates = predicates[0];\r\n        }\r\n        return new Predicate(predicates[0], operator, predicates.slice(1));\r\n    };\r\n    Predicate.combine = function (pred, field, operator, value, condition, ignoreCase, ignoreAccent) {\r\n        if (field instanceof Predicate) {\r\n            return Predicate[condition](pred, field);\r\n        }\r\n        if (typeof field === 'string') {\r\n            return Predicate[condition](pred, new Predicate(field, operator, value, ignoreCase, ignoreAccent));\r\n        }\r\n        return DataUtil.throwError('Predicate - ' + condition + ' : invalid arguments');\r\n    };\r\n    Predicate.fromJSONData = function (json) {\r\n        var preds = json.predicates || [];\r\n        var len = preds.length;\r\n        var predicates = [];\r\n        var result;\r\n        for (var i = 0; i < len; i++) {\r\n            predicates.push(this.fromJSONData(preds[i]));\r\n        }\r\n        if (!json.isComplex) {\r\n            result = new Predicate(json.field, json.operator, json.value, json.ignoreCase, json.ignoreAccent);\r\n        }\r\n        else {\r\n            result = new Predicate(predicates[0], json.condition, predicates.slice(1));\r\n        }\r\n        return result;\r\n    };\r\n    return Predicate;\r\n}());\r\nexport { Predicate };\r\n"]},"metadata":{},"sourceType":"module"}