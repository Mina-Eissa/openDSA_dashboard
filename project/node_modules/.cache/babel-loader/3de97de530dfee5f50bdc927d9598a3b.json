{"ast":null,"code":"import { isNumber } from './is.js';\n/**\r\n * @typedef {{sign: '+' | '-' | '', coefficients: number[], exponent: number}} SplitValue\r\n */\n\n/**\r\n * Check if a number is integer\r\n * @param {number | boolean} value\r\n * @return {boolean} isInteger\r\n */\n\nexport function isInteger(value) {\n  if (typeof value === 'boolean') {\n    return true;\n  }\n\n  return isFinite(value) ? value === Math.round(value) : false;\n}\n/**\r\n * Calculate the sign of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\n\nexport var sign = /* #__PURE__ */Math.sign || function (x) {\n  if (x > 0) {\n    return 1;\n  } else if (x < 0) {\n    return -1;\n  } else {\n    return 0;\n  }\n};\n/**\r\n * Calculate the base-2 logarithm of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\n\nexport var log2 = /* #__PURE__ */Math.log2 || function log2(x) {\n  return Math.log(x) / Math.LN2;\n};\n/**\r\n * Calculate the base-10 logarithm of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\n\nexport var log10 = /* #__PURE__ */Math.log10 || function log10(x) {\n  return Math.log(x) / Math.LN10;\n};\n/**\r\n * Calculate the natural logarithm of a number + 1\r\n * @param {number} x\r\n * @returns {number}\r\n */\n\nexport var log1p = /* #__PURE__ */Math.log1p || function (x) {\n  return Math.log(x + 1);\n};\n/**\r\n * Calculate cubic root for a number\r\n *\r\n * Code from es6-shim.js:\r\n *   https://github.com/paulmillr/es6-shim/blob/master/es6-shim.js#L1564-L1577\r\n *\r\n * @param {number} x\r\n * @returns {number} Returns the cubic root of x\r\n */\n\nexport var cbrt = /* #__PURE__ */Math.cbrt || function cbrt(x) {\n  if (x === 0) {\n    return x;\n  }\n\n  var negate = x < 0;\n  var result;\n\n  if (negate) {\n    x = -x;\n  }\n\n  if (isFinite(x)) {\n    result = Math.exp(Math.log(x) / 3); // from https://en.wikipedia.org/wiki/Cube_root#Numerical_methods\n\n    result = (x / (result * result) + 2 * result) / 3;\n  } else {\n    result = x;\n  }\n\n  return negate ? -result : result;\n};\n/**\r\n * Calculates exponentiation minus 1\r\n * @param {number} x\r\n * @return {number} res\r\n */\n\nexport var expm1 = /* #__PURE__ */Math.expm1 || function expm1(x) {\n  return x >= 2e-4 || x <= -2e-4 ? Math.exp(x) - 1 : x + x * x / 2 + x * x * x / 6;\n};\n/**\r\n * Formats a number in a given base\r\n * @param {number} n\r\n * @param {number} base\r\n * @param {number} size\r\n * @returns {string}\r\n */\n\nfunction formatNumberToBase(n, base, size) {\n  var prefixes = {\n    2: '0b',\n    8: '0o',\n    16: '0x'\n  };\n  var prefix = prefixes[base];\n  var suffix = '';\n\n  if (size) {\n    if (size < 1) {\n      throw new Error('size must be in greater than 0');\n    }\n\n    if (!isInteger(size)) {\n      throw new Error('size must be an integer');\n    }\n\n    if (n > 2 ** (size - 1) - 1 || n < -(2 ** (size - 1))) {\n      throw new Error(\"Value must be in range [-2^\".concat(size - 1, \", 2^\").concat(size - 1, \"-1]\"));\n    }\n\n    if (!isInteger(n)) {\n      throw new Error('Value must be an integer');\n    }\n\n    if (n < 0) {\n      n = n + 2 ** size;\n    }\n\n    suffix = \"i\".concat(size);\n  }\n\n  var sign = '';\n\n  if (n < 0) {\n    n = -n;\n    sign = '-';\n  }\n\n  return \"\".concat(sign).concat(prefix).concat(n.toString(base)).concat(suffix);\n}\n/**\r\n * Convert a number to a formatted string representation.\r\n *\r\n * Syntax:\r\n *\r\n *    format(value)\r\n *    format(value, options)\r\n *    format(value, precision)\r\n *    format(value, fn)\r\n *\r\n * Where:\r\n *\r\n *    {number} value   The value to be formatted\r\n *    {Object} options An object with formatting options. Available options:\r\n *                     {string} notation\r\n *                         Number notation. Choose from:\r\n *                         'fixed'          Always use regular number notation.\r\n *                                          For example '123.40' and '14000000'\r\n *                         'exponential'    Always use exponential notation.\r\n *                                          For example '1.234e+2' and '1.4e+7'\r\n *                         'engineering'    Always use engineering notation.\r\n *                                          For example '123.4e+0' and '14.0e+6'\r\n *                         'auto' (default) Regular number notation for numbers\r\n *                                          having an absolute value between\r\n *                                          `lowerExp` and `upperExp` bounds, and\r\n *                                          uses exponential notation elsewhere.\r\n *                                          Lower bound is included, upper bound\r\n *                                          is excluded.\r\n *                                          For example '123.4' and '1.4e7'.\r\n *                         'bin', 'oct, or\r\n *                         'hex'            Format the number using binary, octal,\r\n *                                          or hexadecimal notation.\r\n *                                          For example '0b1101' and '0x10fe'.\r\n *                     {number} wordSize    The word size in bits to use for formatting\r\n *                                          in binary, octal, or hexadecimal notation.\r\n *                                          To be used only with 'bin', 'oct', or 'hex'\r\n *                                          values for 'notation' option. When this option\r\n *                                          is defined the value is formatted as a signed\r\n *                                          twos complement integer of the given word size\r\n *                                          and the size suffix is appended to the output.\r\n *                                          For example\r\n *                                          format(-1, {notation: 'hex', wordSize: 8}) === '0xffi8'.\r\n *                                          Default value is undefined.\r\n *                     {number} precision   A number between 0 and 16 to round\r\n *                                          the digits of the number.\r\n *                                          In case of notations 'exponential',\r\n *                                          'engineering', and 'auto',\r\n *                                          `precision` defines the total\r\n *                                          number of significant digits returned.\r\n *                                          In case of notation 'fixed',\r\n *                                          `precision` defines the number of\r\n *                                          significant digits after the decimal\r\n *                                          point.\r\n *                                          `precision` is undefined by default,\r\n *                                          not rounding any digits.\r\n *                     {number} lowerExp    Exponent determining the lower boundary\r\n *                                          for formatting a value with an exponent\r\n *                                          when `notation='auto`.\r\n *                                          Default value is `-3`.\r\n *                     {number} upperExp    Exponent determining the upper boundary\r\n *                                          for formatting a value with an exponent\r\n *                                          when `notation='auto`.\r\n *                                          Default value is `5`.\r\n *    {Function} fn    A custom formatting function. Can be used to override the\r\n *                     built-in notations. Function `fn` is called with `value` as\r\n *                     parameter and must return a string. Is useful for example to\r\n *                     format all values inside a matrix in a particular way.\r\n *\r\n * Examples:\r\n *\r\n *    format(6.4)                                        // '6.4'\r\n *    format(1240000)                                    // '1.24e6'\r\n *    format(1/3)                                        // '0.3333333333333333'\r\n *    format(1/3, 3)                                     // '0.333'\r\n *    format(21385, 2)                                   // '21000'\r\n *    format(12.071, {notation: 'fixed'})                // '12'\r\n *    format(2.3,    {notation: 'fixed', precision: 2})  // '2.30'\r\n *    format(52.8,   {notation: 'exponential'})          // '5.28e+1'\r\n *    format(12345678, {notation: 'engineering'})        // '12.345678e+6'\r\n *\r\n * @param {number} value\r\n * @param {Object | Function | number} [options]\r\n * @return {string} str The formatted value\r\n */\n\n\nexport function format(value, options) {\n  if (typeof options === 'function') {\n    // handle format(value, fn)\n    return options(value);\n  } // handle special cases\n\n\n  if (value === Infinity) {\n    return 'Infinity';\n  } else if (value === -Infinity) {\n    return '-Infinity';\n  } else if (isNaN(value)) {\n    return 'NaN';\n  } // default values for options\n\n\n  var notation = 'auto';\n  var precision;\n  var wordSize;\n\n  if (options) {\n    // determine notation from options\n    if (options.notation) {\n      notation = options.notation;\n    } // determine precision from options\n\n\n    if (isNumber(options)) {\n      precision = options;\n    } else if (isNumber(options.precision)) {\n      precision = options.precision;\n    }\n\n    if (options.wordSize) {\n      wordSize = options.wordSize;\n\n      if (typeof wordSize !== 'number') {\n        throw new Error('Option \"wordSize\" must be a number');\n      }\n    }\n  } // handle the various notations\n\n\n  switch (notation) {\n    case 'fixed':\n      return toFixed(value, precision);\n\n    case 'exponential':\n      return toExponential(value, precision);\n\n    case 'engineering':\n      return toEngineering(value, precision);\n\n    case 'bin':\n      return formatNumberToBase(value, 2, wordSize);\n\n    case 'oct':\n      return formatNumberToBase(value, 8, wordSize);\n\n    case 'hex':\n      return formatNumberToBase(value, 16, wordSize);\n\n    case 'auto':\n      // remove trailing zeros after the decimal point\n      return toPrecision(value, precision, options && options).replace(/((\\.\\d*?)(0+))($|e)/, function () {\n        var digits = arguments[2];\n        var e = arguments[4];\n        return digits !== '.' ? digits + e : e;\n      });\n\n    default:\n      throw new Error('Unknown notation \"' + notation + '\". ' + 'Choose \"auto\", \"exponential\", \"fixed\", \"bin\", \"oct\", or \"hex.');\n  }\n}\n/**\r\n * Split a number into sign, coefficients, and exponent\r\n * @param {number | string} value\r\n * @return {SplitValue}\r\n *              Returns an object containing sign, coefficients, and exponent\r\n */\n\nexport function splitNumber(value) {\n  // parse the input value\n  var match = String(value).toLowerCase().match(/^(-?)(\\d+\\.?\\d*)(e([+-]?\\d+))?$/);\n\n  if (!match) {\n    throw new SyntaxError('Invalid number ' + value);\n  }\n\n  var sign = match[1];\n  var digits = match[2];\n  var exponent = parseFloat(match[4] || '0');\n  var dot = digits.indexOf('.');\n  exponent += dot !== -1 ? dot - 1 : digits.length - 1;\n  var coefficients = digits.replace('.', '') // remove the dot (must be removed before removing leading zeros)\n  .replace(/^0*/, function (zeros) {\n    // remove leading zeros, add their count to the exponent\n    exponent -= zeros.length;\n    return '';\n  }).replace(/0*$/, '') // remove trailing zeros\n  .split('').map(function (d) {\n    return parseInt(d);\n  });\n\n  if (coefficients.length === 0) {\n    coefficients.push(0);\n    exponent++;\n  }\n\n  return {\n    sign,\n    coefficients,\n    exponent\n  };\n}\n/**\r\n * Format a number in engineering notation. Like '1.23e+6', '2.3e+0', '3.500e-3'\r\n * @param {number | string} value\r\n * @param {number} [precision]        Optional number of significant figures to return.\r\n */\n\nexport function toEngineering(value, precision) {\n  if (isNaN(value) || !isFinite(value)) {\n    return String(value);\n  }\n\n  var split = splitNumber(value);\n  var rounded = roundDigits(split, precision);\n  var e = rounded.exponent;\n  var c = rounded.coefficients; // find nearest lower multiple of 3 for exponent\n\n  var newExp = e % 3 === 0 ? e : e < 0 ? e - 3 - e % 3 : e - e % 3;\n\n  if (isNumber(precision)) {\n    // add zeroes to give correct sig figs\n    while (precision > c.length || e - newExp + 1 > c.length) {\n      c.push(0);\n    }\n  } else {\n    // concatenate coefficients with necessary zeros\n    // add zeros if necessary (for example: 1e+8 -> 100e+6)\n    var missingZeros = Math.abs(e - newExp) - (c.length - 1);\n\n    for (var i = 0; i < missingZeros; i++) {\n      c.push(0);\n    }\n  } // find difference in exponents\n\n\n  var expDiff = Math.abs(e - newExp);\n  var decimalIdx = 1; // push decimal index over by expDiff times\n\n  while (expDiff > 0) {\n    decimalIdx++;\n    expDiff--;\n  } // if all coefficient values are zero after the decimal point and precision is unset, don't add a decimal value.\n  // otherwise concat with the rest of the coefficients\n\n\n  var decimals = c.slice(decimalIdx).join('');\n  var decimalVal = isNumber(precision) && decimals.length || decimals.match(/[1-9]/) ? '.' + decimals : '';\n  var str = c.slice(0, decimalIdx).join('') + decimalVal + 'e' + (e >= 0 ? '+' : '') + newExp.toString();\n  return rounded.sign + str;\n}\n/**\r\n * Format a number with fixed notation.\r\n * @param {number | string} value\r\n * @param {number} [precision=undefined]  Optional number of decimals after the\r\n *                                        decimal point. null by default.\r\n */\n\nexport function toFixed(value, precision) {\n  if (isNaN(value) || !isFinite(value)) {\n    return String(value);\n  }\n\n  var splitValue = splitNumber(value);\n  var rounded = typeof precision === 'number' ? roundDigits(splitValue, splitValue.exponent + 1 + precision) : splitValue;\n  var c = rounded.coefficients;\n  var p = rounded.exponent + 1; // exponent may have changed\n  // append zeros if needed\n\n  var pp = p + (precision || 0);\n\n  if (c.length < pp) {\n    c = c.concat(zeros(pp - c.length));\n  } // prepend zeros if needed\n\n\n  if (p < 0) {\n    c = zeros(-p + 1).concat(c);\n    p = 1;\n  } // insert a dot if needed\n\n\n  if (p < c.length) {\n    c.splice(p, 0, p === 0 ? '0.' : '.');\n  }\n\n  return rounded.sign + c.join('');\n}\n/**\r\n * Format a number in exponential notation. Like '1.23e+5', '2.3e+0', '3.500e-3'\r\n * @param {number | string} value\r\n * @param {number} [precision]  Number of digits in formatted output.\r\n *                              If not provided, the maximum available digits\r\n *                              is used.\r\n */\n\nexport function toExponential(value, precision) {\n  if (isNaN(value) || !isFinite(value)) {\n    return String(value);\n  } // round if needed, else create a clone\n\n\n  var split = splitNumber(value);\n  var rounded = precision ? roundDigits(split, precision) : split;\n  var c = rounded.coefficients;\n  var e = rounded.exponent; // append zeros if needed\n\n  if (c.length < precision) {\n    c = c.concat(zeros(precision - c.length));\n  } // format as `C.CCCe+EEE` or `C.CCCe-EEE`\n\n\n  var first = c.shift();\n  return rounded.sign + first + (c.length > 0 ? '.' + c.join('') : '') + 'e' + (e >= 0 ? '+' : '') + e;\n}\n/**\r\n * Format a number with a certain precision\r\n * @param {number | string} value\r\n * @param {number} [precision=undefined] Optional number of digits.\r\n * @param {{lowerExp: number | undefined, upperExp: number | undefined}} [options]\r\n *                                       By default:\r\n *                                         lowerExp = -3 (incl)\r\n *                                         upper = +5 (excl)\r\n * @return {string}\r\n */\n\nexport function toPrecision(value, precision, options) {\n  if (isNaN(value) || !isFinite(value)) {\n    return String(value);\n  } // determine lower and upper bound for exponential notation.\n\n\n  var lowerExp = options && options.lowerExp !== undefined ? options.lowerExp : -3;\n  var upperExp = options && options.upperExp !== undefined ? options.upperExp : 5;\n  var split = splitNumber(value);\n  var rounded = precision ? roundDigits(split, precision) : split;\n\n  if (rounded.exponent < lowerExp || rounded.exponent >= upperExp) {\n    // exponential notation\n    return toExponential(value, precision);\n  } else {\n    var c = rounded.coefficients;\n    var e = rounded.exponent; // append trailing zeros\n\n    if (c.length < precision) {\n      c = c.concat(zeros(precision - c.length));\n    } // append trailing zeros\n    // TODO: simplify the next statement\n\n\n    c = c.concat(zeros(e - c.length + 1 + (c.length < precision ? precision - c.length : 0))); // prepend zeros\n\n    c = zeros(-e).concat(c);\n    var dot = e > 0 ? e : 0;\n\n    if (dot < c.length - 1) {\n      c.splice(dot + 1, 0, '.');\n    }\n\n    return rounded.sign + c.join('');\n  }\n}\n/**\r\n * Round the number of digits of a number *\r\n * @param {SplitValue} split       A value split with .splitNumber(value)\r\n * @param {number} precision  A positive integer\r\n * @return {SplitValue}\r\n *              Returns an object containing sign, coefficients, and exponent\r\n *              with rounded digits\r\n */\n\nexport function roundDigits(split, precision) {\n  // create a clone\n  var rounded = {\n    sign: split.sign,\n    coefficients: split.coefficients,\n    exponent: split.exponent\n  };\n  var c = rounded.coefficients; // prepend zeros if needed\n\n  while (precision <= 0) {\n    c.unshift(0);\n    rounded.exponent++;\n    precision++;\n  }\n\n  if (c.length > precision) {\n    var removed = c.splice(precision, c.length - precision);\n\n    if (removed[0] >= 5) {\n      var i = precision - 1;\n      c[i]++;\n\n      while (c[i] === 10) {\n        c.pop();\n\n        if (i === 0) {\n          c.unshift(0);\n          rounded.exponent++;\n          i++;\n        }\n\n        i--;\n        c[i]++;\n      }\n    }\n  }\n\n  return rounded;\n}\n/**\r\n * Create an array filled with zeros.\r\n * @param {number} length\r\n * @return {Array}\r\n */\n\nfunction zeros(length) {\n  var arr = [];\n\n  for (var i = 0; i < length; i++) {\n    arr.push(0);\n  }\n\n  return arr;\n}\n/**\r\n * Count the number of significant digits of a number.\r\n *\r\n * For example:\r\n *   2.34 returns 3\r\n *   0.0034 returns 2\r\n *   120.5e+30 returns 4\r\n *\r\n * @param {number} value\r\n * @return {number} digits   Number of significant digits\r\n */\n\n\nexport function digits(value) {\n  return value.toExponential().replace(/e.*$/, '') // remove exponential notation\n  .replace(/^0\\.?0*|\\./, '') // remove decimal point and leading zeros\n  .length;\n}\n/**\r\n * Minimum number added to one that makes the result different than one\r\n */\n\nexport var DBL_EPSILON = Number.EPSILON || 2.2204460492503130808472633361816E-16;\n/**\r\n * Compares two floating point numbers.\r\n * @param {number} x          First value to compare\r\n * @param {number} y          Second value to compare\r\n * @param {number} [epsilon]  The maximum relative difference between x and y\r\n *                            If epsilon is undefined or null, the function will\r\n *                            test whether x and y are exactly equal.\r\n * @return {boolean} whether the two numbers are nearly equal\r\n*/\n\nexport function nearlyEqual(x, y, epsilon) {\n  // if epsilon is null or undefined, test whether x and y are exactly equal\n  if (epsilon === null || epsilon === undefined) {\n    return x === y;\n  }\n\n  if (x === y) {\n    return true;\n  } // NaN\n\n\n  if (isNaN(x) || isNaN(y)) {\n    return false;\n  } // at this point x and y should be finite\n\n\n  if (isFinite(x) && isFinite(y)) {\n    // check numbers are very close, needed when comparing numbers near zero\n    var diff = Math.abs(x - y);\n\n    if (diff < DBL_EPSILON) {\n      return true;\n    } else {\n      // use relative error\n      return diff <= Math.max(Math.abs(x), Math.abs(y)) * epsilon;\n    }\n  } // Infinite and Number or negative Infinite and positive Infinite cases\n\n\n  return false;\n}\n/**\r\n * Calculate the hyperbolic arccos of a number\r\n * @param {number} x\r\n * @return {number}\r\n */\n\nexport var acosh = Math.acosh || function (x) {\n  return Math.log(Math.sqrt(x * x - 1) + x);\n};\nexport var asinh = Math.asinh || function (x) {\n  return Math.log(Math.sqrt(x * x + 1) + x);\n};\n/**\r\n * Calculate the hyperbolic arctangent of a number\r\n * @param {number} x\r\n * @return {number}\r\n */\n\nexport var atanh = Math.atanh || function (x) {\n  return Math.log((1 + x) / (1 - x)) / 2;\n};\n/**\r\n * Calculate the hyperbolic cosine of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\n\nexport var cosh = Math.cosh || function (x) {\n  return (Math.exp(x) + Math.exp(-x)) / 2;\n};\n/**\r\n * Calculate the hyperbolic sine of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\n\nexport var sinh = Math.sinh || function (x) {\n  return (Math.exp(x) - Math.exp(-x)) / 2;\n};\n/**\r\n * Calculate the hyperbolic tangent of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\n\nexport var tanh = Math.tanh || function (x) {\n  var e = Math.exp(2 * x);\n  return (e - 1) / (e + 1);\n};\n/**\r\n * Returns a value with the magnitude of x and the sign of y.\r\n * @param {number} x\r\n * @param {number} y\r\n * @returns {number}\r\n */\n\nexport function copysign(x, y) {\n  var signx = x > 0 ? true : x < 0 ? false : 1 / x === Infinity;\n  var signy = y > 0 ? true : y < 0 ? false : 1 / y === Infinity;\n  return signx ^ signy ? -x : x;\n}","map":{"version":3,"sources":["C:/Users/x/Desktop/openDSA/openDSA_dashboard/project/node_modules/mathjs/lib/esm/utils/number.js"],"names":["isNumber","isInteger","value","isFinite","Math","round","sign","x","log2","log","LN2","log10","LN10","log1p","cbrt","negate","result","exp","expm1","formatNumberToBase","n","base","size","prefixes","prefix","suffix","Error","concat","toString","format","options","Infinity","isNaN","notation","precision","wordSize","toFixed","toExponential","toEngineering","toPrecision","replace","digits","arguments","e","splitNumber","match","String","toLowerCase","SyntaxError","exponent","parseFloat","dot","indexOf","length","coefficients","zeros","split","map","d","parseInt","push","rounded","roundDigits","c","newExp","missingZeros","abs","i","expDiff","decimalIdx","decimals","slice","join","decimalVal","str","splitValue","p","pp","splice","first","shift","lowerExp","undefined","upperExp","unshift","removed","pop","arr","DBL_EPSILON","Number","EPSILON","nearlyEqual","y","epsilon","diff","max","acosh","sqrt","asinh","atanh","cosh","sinh","tanh","copysign","signx","signy"],"mappings":"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","sourcesContent":["import { isNumber } from './is.js';\r\n\r\n/**\r\n * @typedef {{sign: '+' | '-' | '', coefficients: number[], exponent: number}} SplitValue\r\n */\r\n\r\n/**\r\n * Check if a number is integer\r\n * @param {number | boolean} value\r\n * @return {boolean} isInteger\r\n */\r\nexport function isInteger(value) {\r\n  if (typeof value === 'boolean') {\r\n    return true;\r\n  }\r\n  return isFinite(value) ? value === Math.round(value) : false;\r\n}\r\n\r\n/**\r\n * Calculate the sign of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\r\nexport var sign = /* #__PURE__ */Math.sign || function (x) {\r\n  if (x > 0) {\r\n    return 1;\r\n  } else if (x < 0) {\r\n    return -1;\r\n  } else {\r\n    return 0;\r\n  }\r\n};\r\n\r\n/**\r\n * Calculate the base-2 logarithm of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\r\nexport var log2 = /* #__PURE__ */Math.log2 || function log2(x) {\r\n  return Math.log(x) / Math.LN2;\r\n};\r\n\r\n/**\r\n * Calculate the base-10 logarithm of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\r\nexport var log10 = /* #__PURE__ */Math.log10 || function log10(x) {\r\n  return Math.log(x) / Math.LN10;\r\n};\r\n\r\n/**\r\n * Calculate the natural logarithm of a number + 1\r\n * @param {number} x\r\n * @returns {number}\r\n */\r\nexport var log1p = /* #__PURE__ */Math.log1p || function (x) {\r\n  return Math.log(x + 1);\r\n};\r\n\r\n/**\r\n * Calculate cubic root for a number\r\n *\r\n * Code from es6-shim.js:\r\n *   https://github.com/paulmillr/es6-shim/blob/master/es6-shim.js#L1564-L1577\r\n *\r\n * @param {number} x\r\n * @returns {number} Returns the cubic root of x\r\n */\r\nexport var cbrt = /* #__PURE__ */Math.cbrt || function cbrt(x) {\r\n  if (x === 0) {\r\n    return x;\r\n  }\r\n  var negate = x < 0;\r\n  var result;\r\n  if (negate) {\r\n    x = -x;\r\n  }\r\n  if (isFinite(x)) {\r\n    result = Math.exp(Math.log(x) / 3);\r\n    // from https://en.wikipedia.org/wiki/Cube_root#Numerical_methods\r\n    result = (x / (result * result) + 2 * result) / 3;\r\n  } else {\r\n    result = x;\r\n  }\r\n  return negate ? -result : result;\r\n};\r\n\r\n/**\r\n * Calculates exponentiation minus 1\r\n * @param {number} x\r\n * @return {number} res\r\n */\r\nexport var expm1 = /* #__PURE__ */Math.expm1 || function expm1(x) {\r\n  return x >= 2e-4 || x <= -2e-4 ? Math.exp(x) - 1 : x + x * x / 2 + x * x * x / 6;\r\n};\r\n\r\n/**\r\n * Formats a number in a given base\r\n * @param {number} n\r\n * @param {number} base\r\n * @param {number} size\r\n * @returns {string}\r\n */\r\nfunction formatNumberToBase(n, base, size) {\r\n  var prefixes = {\r\n    2: '0b',\r\n    8: '0o',\r\n    16: '0x'\r\n  };\r\n  var prefix = prefixes[base];\r\n  var suffix = '';\r\n  if (size) {\r\n    if (size < 1) {\r\n      throw new Error('size must be in greater than 0');\r\n    }\r\n    if (!isInteger(size)) {\r\n      throw new Error('size must be an integer');\r\n    }\r\n    if (n > 2 ** (size - 1) - 1 || n < -(2 ** (size - 1))) {\r\n      throw new Error(\"Value must be in range [-2^\".concat(size - 1, \", 2^\").concat(size - 1, \"-1]\"));\r\n    }\r\n    if (!isInteger(n)) {\r\n      throw new Error('Value must be an integer');\r\n    }\r\n    if (n < 0) {\r\n      n = n + 2 ** size;\r\n    }\r\n    suffix = \"i\".concat(size);\r\n  }\r\n  var sign = '';\r\n  if (n < 0) {\r\n    n = -n;\r\n    sign = '-';\r\n  }\r\n  return \"\".concat(sign).concat(prefix).concat(n.toString(base)).concat(suffix);\r\n}\r\n\r\n/**\r\n * Convert a number to a formatted string representation.\r\n *\r\n * Syntax:\r\n *\r\n *    format(value)\r\n *    format(value, options)\r\n *    format(value, precision)\r\n *    format(value, fn)\r\n *\r\n * Where:\r\n *\r\n *    {number} value   The value to be formatted\r\n *    {Object} options An object with formatting options. Available options:\r\n *                     {string} notation\r\n *                         Number notation. Choose from:\r\n *                         'fixed'          Always use regular number notation.\r\n *                                          For example '123.40' and '14000000'\r\n *                         'exponential'    Always use exponential notation.\r\n *                                          For example '1.234e+2' and '1.4e+7'\r\n *                         'engineering'    Always use engineering notation.\r\n *                                          For example '123.4e+0' and '14.0e+6'\r\n *                         'auto' (default) Regular number notation for numbers\r\n *                                          having an absolute value between\r\n *                                          `lowerExp` and `upperExp` bounds, and\r\n *                                          uses exponential notation elsewhere.\r\n *                                          Lower bound is included, upper bound\r\n *                                          is excluded.\r\n *                                          For example '123.4' and '1.4e7'.\r\n *                         'bin', 'oct, or\r\n *                         'hex'            Format the number using binary, octal,\r\n *                                          or hexadecimal notation.\r\n *                                          For example '0b1101' and '0x10fe'.\r\n *                     {number} wordSize    The word size in bits to use for formatting\r\n *                                          in binary, octal, or hexadecimal notation.\r\n *                                          To be used only with 'bin', 'oct', or 'hex'\r\n *                                          values for 'notation' option. When this option\r\n *                                          is defined the value is formatted as a signed\r\n *                                          twos complement integer of the given word size\r\n *                                          and the size suffix is appended to the output.\r\n *                                          For example\r\n *                                          format(-1, {notation: 'hex', wordSize: 8}) === '0xffi8'.\r\n *                                          Default value is undefined.\r\n *                     {number} precision   A number between 0 and 16 to round\r\n *                                          the digits of the number.\r\n *                                          In case of notations 'exponential',\r\n *                                          'engineering', and 'auto',\r\n *                                          `precision` defines the total\r\n *                                          number of significant digits returned.\r\n *                                          In case of notation 'fixed',\r\n *                                          `precision` defines the number of\r\n *                                          significant digits after the decimal\r\n *                                          point.\r\n *                                          `precision` is undefined by default,\r\n *                                          not rounding any digits.\r\n *                     {number} lowerExp    Exponent determining the lower boundary\r\n *                                          for formatting a value with an exponent\r\n *                                          when `notation='auto`.\r\n *                                          Default value is `-3`.\r\n *                     {number} upperExp    Exponent determining the upper boundary\r\n *                                          for formatting a value with an exponent\r\n *                                          when `notation='auto`.\r\n *                                          Default value is `5`.\r\n *    {Function} fn    A custom formatting function. Can be used to override the\r\n *                     built-in notations. Function `fn` is called with `value` as\r\n *                     parameter and must return a string. Is useful for example to\r\n *                     format all values inside a matrix in a particular way.\r\n *\r\n * Examples:\r\n *\r\n *    format(6.4)                                        // '6.4'\r\n *    format(1240000)                                    // '1.24e6'\r\n *    format(1/3)                                        // '0.3333333333333333'\r\n *    format(1/3, 3)                                     // '0.333'\r\n *    format(21385, 2)                                   // '21000'\r\n *    format(12.071, {notation: 'fixed'})                // '12'\r\n *    format(2.3,    {notation: 'fixed', precision: 2})  // '2.30'\r\n *    format(52.8,   {notation: 'exponential'})          // '5.28e+1'\r\n *    format(12345678, {notation: 'engineering'})        // '12.345678e+6'\r\n *\r\n * @param {number} value\r\n * @param {Object | Function | number} [options]\r\n * @return {string} str The formatted value\r\n */\r\nexport function format(value, options) {\r\n  if (typeof options === 'function') {\r\n    // handle format(value, fn)\r\n    return options(value);\r\n  }\r\n\r\n  // handle special cases\r\n  if (value === Infinity) {\r\n    return 'Infinity';\r\n  } else if (value === -Infinity) {\r\n    return '-Infinity';\r\n  } else if (isNaN(value)) {\r\n    return 'NaN';\r\n  }\r\n\r\n  // default values for options\r\n  var notation = 'auto';\r\n  var precision;\r\n  var wordSize;\r\n  if (options) {\r\n    // determine notation from options\r\n    if (options.notation) {\r\n      notation = options.notation;\r\n    }\r\n\r\n    // determine precision from options\r\n    if (isNumber(options)) {\r\n      precision = options;\r\n    } else if (isNumber(options.precision)) {\r\n      precision = options.precision;\r\n    }\r\n    if (options.wordSize) {\r\n      wordSize = options.wordSize;\r\n      if (typeof wordSize !== 'number') {\r\n        throw new Error('Option \"wordSize\" must be a number');\r\n      }\r\n    }\r\n  }\r\n\r\n  // handle the various notations\r\n  switch (notation) {\r\n    case 'fixed':\r\n      return toFixed(value, precision);\r\n    case 'exponential':\r\n      return toExponential(value, precision);\r\n    case 'engineering':\r\n      return toEngineering(value, precision);\r\n    case 'bin':\r\n      return formatNumberToBase(value, 2, wordSize);\r\n    case 'oct':\r\n      return formatNumberToBase(value, 8, wordSize);\r\n    case 'hex':\r\n      return formatNumberToBase(value, 16, wordSize);\r\n    case 'auto':\r\n      // remove trailing zeros after the decimal point\r\n      return toPrecision(value, precision, options && options).replace(/((\\.\\d*?)(0+))($|e)/, function () {\r\n        var digits = arguments[2];\r\n        var e = arguments[4];\r\n        return digits !== '.' ? digits + e : e;\r\n      });\r\n    default:\r\n      throw new Error('Unknown notation \"' + notation + '\". ' + 'Choose \"auto\", \"exponential\", \"fixed\", \"bin\", \"oct\", or \"hex.');\r\n  }\r\n}\r\n\r\n/**\r\n * Split a number into sign, coefficients, and exponent\r\n * @param {number | string} value\r\n * @return {SplitValue}\r\n *              Returns an object containing sign, coefficients, and exponent\r\n */\r\nexport function splitNumber(value) {\r\n  // parse the input value\r\n  var match = String(value).toLowerCase().match(/^(-?)(\\d+\\.?\\d*)(e([+-]?\\d+))?$/);\r\n  if (!match) {\r\n    throw new SyntaxError('Invalid number ' + value);\r\n  }\r\n  var sign = match[1];\r\n  var digits = match[2];\r\n  var exponent = parseFloat(match[4] || '0');\r\n  var dot = digits.indexOf('.');\r\n  exponent += dot !== -1 ? dot - 1 : digits.length - 1;\r\n  var coefficients = digits.replace('.', '') // remove the dot (must be removed before removing leading zeros)\r\n  .replace(/^0*/, function (zeros) {\r\n    // remove leading zeros, add their count to the exponent\r\n    exponent -= zeros.length;\r\n    return '';\r\n  }).replace(/0*$/, '') // remove trailing zeros\r\n  .split('').map(function (d) {\r\n    return parseInt(d);\r\n  });\r\n  if (coefficients.length === 0) {\r\n    coefficients.push(0);\r\n    exponent++;\r\n  }\r\n  return {\r\n    sign,\r\n    coefficients,\r\n    exponent\r\n  };\r\n}\r\n\r\n/**\r\n * Format a number in engineering notation. Like '1.23e+6', '2.3e+0', '3.500e-3'\r\n * @param {number | string} value\r\n * @param {number} [precision]        Optional number of significant figures to return.\r\n */\r\nexport function toEngineering(value, precision) {\r\n  if (isNaN(value) || !isFinite(value)) {\r\n    return String(value);\r\n  }\r\n  var split = splitNumber(value);\r\n  var rounded = roundDigits(split, precision);\r\n  var e = rounded.exponent;\r\n  var c = rounded.coefficients;\r\n\r\n  // find nearest lower multiple of 3 for exponent\r\n  var newExp = e % 3 === 0 ? e : e < 0 ? e - 3 - e % 3 : e - e % 3;\r\n  if (isNumber(precision)) {\r\n    // add zeroes to give correct sig figs\r\n    while (precision > c.length || e - newExp + 1 > c.length) {\r\n      c.push(0);\r\n    }\r\n  } else {\r\n    // concatenate coefficients with necessary zeros\r\n    // add zeros if necessary (for example: 1e+8 -> 100e+6)\r\n    var missingZeros = Math.abs(e - newExp) - (c.length - 1);\r\n    for (var i = 0; i < missingZeros; i++) {\r\n      c.push(0);\r\n    }\r\n  }\r\n\r\n  // find difference in exponents\r\n  var expDiff = Math.abs(e - newExp);\r\n  var decimalIdx = 1;\r\n\r\n  // push decimal index over by expDiff times\r\n  while (expDiff > 0) {\r\n    decimalIdx++;\r\n    expDiff--;\r\n  }\r\n\r\n  // if all coefficient values are zero after the decimal point and precision is unset, don't add a decimal value.\r\n  // otherwise concat with the rest of the coefficients\r\n  var decimals = c.slice(decimalIdx).join('');\r\n  var decimalVal = isNumber(precision) && decimals.length || decimals.match(/[1-9]/) ? '.' + decimals : '';\r\n  var str = c.slice(0, decimalIdx).join('') + decimalVal + 'e' + (e >= 0 ? '+' : '') + newExp.toString();\r\n  return rounded.sign + str;\r\n}\r\n\r\n/**\r\n * Format a number with fixed notation.\r\n * @param {number | string} value\r\n * @param {number} [precision=undefined]  Optional number of decimals after the\r\n *                                        decimal point. null by default.\r\n */\r\nexport function toFixed(value, precision) {\r\n  if (isNaN(value) || !isFinite(value)) {\r\n    return String(value);\r\n  }\r\n  var splitValue = splitNumber(value);\r\n  var rounded = typeof precision === 'number' ? roundDigits(splitValue, splitValue.exponent + 1 + precision) : splitValue;\r\n  var c = rounded.coefficients;\r\n  var p = rounded.exponent + 1; // exponent may have changed\r\n\r\n  // append zeros if needed\r\n  var pp = p + (precision || 0);\r\n  if (c.length < pp) {\r\n    c = c.concat(zeros(pp - c.length));\r\n  }\r\n\r\n  // prepend zeros if needed\r\n  if (p < 0) {\r\n    c = zeros(-p + 1).concat(c);\r\n    p = 1;\r\n  }\r\n\r\n  // insert a dot if needed\r\n  if (p < c.length) {\r\n    c.splice(p, 0, p === 0 ? '0.' : '.');\r\n  }\r\n  return rounded.sign + c.join('');\r\n}\r\n\r\n/**\r\n * Format a number in exponential notation. Like '1.23e+5', '2.3e+0', '3.500e-3'\r\n * @param {number | string} value\r\n * @param {number} [precision]  Number of digits in formatted output.\r\n *                              If not provided, the maximum available digits\r\n *                              is used.\r\n */\r\nexport function toExponential(value, precision) {\r\n  if (isNaN(value) || !isFinite(value)) {\r\n    return String(value);\r\n  }\r\n\r\n  // round if needed, else create a clone\r\n  var split = splitNumber(value);\r\n  var rounded = precision ? roundDigits(split, precision) : split;\r\n  var c = rounded.coefficients;\r\n  var e = rounded.exponent;\r\n\r\n  // append zeros if needed\r\n  if (c.length < precision) {\r\n    c = c.concat(zeros(precision - c.length));\r\n  }\r\n\r\n  // format as `C.CCCe+EEE` or `C.CCCe-EEE`\r\n  var first = c.shift();\r\n  return rounded.sign + first + (c.length > 0 ? '.' + c.join('') : '') + 'e' + (e >= 0 ? '+' : '') + e;\r\n}\r\n\r\n/**\r\n * Format a number with a certain precision\r\n * @param {number | string} value\r\n * @param {number} [precision=undefined] Optional number of digits.\r\n * @param {{lowerExp: number | undefined, upperExp: number | undefined}} [options]\r\n *                                       By default:\r\n *                                         lowerExp = -3 (incl)\r\n *                                         upper = +5 (excl)\r\n * @return {string}\r\n */\r\nexport function toPrecision(value, precision, options) {\r\n  if (isNaN(value) || !isFinite(value)) {\r\n    return String(value);\r\n  }\r\n\r\n  // determine lower and upper bound for exponential notation.\r\n  var lowerExp = options && options.lowerExp !== undefined ? options.lowerExp : -3;\r\n  var upperExp = options && options.upperExp !== undefined ? options.upperExp : 5;\r\n  var split = splitNumber(value);\r\n  var rounded = precision ? roundDigits(split, precision) : split;\r\n  if (rounded.exponent < lowerExp || rounded.exponent >= upperExp) {\r\n    // exponential notation\r\n    return toExponential(value, precision);\r\n  } else {\r\n    var c = rounded.coefficients;\r\n    var e = rounded.exponent;\r\n\r\n    // append trailing zeros\r\n    if (c.length < precision) {\r\n      c = c.concat(zeros(precision - c.length));\r\n    }\r\n\r\n    // append trailing zeros\r\n    // TODO: simplify the next statement\r\n    c = c.concat(zeros(e - c.length + 1 + (c.length < precision ? precision - c.length : 0)));\r\n\r\n    // prepend zeros\r\n    c = zeros(-e).concat(c);\r\n    var dot = e > 0 ? e : 0;\r\n    if (dot < c.length - 1) {\r\n      c.splice(dot + 1, 0, '.');\r\n    }\r\n    return rounded.sign + c.join('');\r\n  }\r\n}\r\n\r\n/**\r\n * Round the number of digits of a number *\r\n * @param {SplitValue} split       A value split with .splitNumber(value)\r\n * @param {number} precision  A positive integer\r\n * @return {SplitValue}\r\n *              Returns an object containing sign, coefficients, and exponent\r\n *              with rounded digits\r\n */\r\nexport function roundDigits(split, precision) {\r\n  // create a clone\r\n  var rounded = {\r\n    sign: split.sign,\r\n    coefficients: split.coefficients,\r\n    exponent: split.exponent\r\n  };\r\n  var c = rounded.coefficients;\r\n\r\n  // prepend zeros if needed\r\n  while (precision <= 0) {\r\n    c.unshift(0);\r\n    rounded.exponent++;\r\n    precision++;\r\n  }\r\n  if (c.length > precision) {\r\n    var removed = c.splice(precision, c.length - precision);\r\n    if (removed[0] >= 5) {\r\n      var i = precision - 1;\r\n      c[i]++;\r\n      while (c[i] === 10) {\r\n        c.pop();\r\n        if (i === 0) {\r\n          c.unshift(0);\r\n          rounded.exponent++;\r\n          i++;\r\n        }\r\n        i--;\r\n        c[i]++;\r\n      }\r\n    }\r\n  }\r\n  return rounded;\r\n}\r\n\r\n/**\r\n * Create an array filled with zeros.\r\n * @param {number} length\r\n * @return {Array}\r\n */\r\nfunction zeros(length) {\r\n  var arr = [];\r\n  for (var i = 0; i < length; i++) {\r\n    arr.push(0);\r\n  }\r\n  return arr;\r\n}\r\n\r\n/**\r\n * Count the number of significant digits of a number.\r\n *\r\n * For example:\r\n *   2.34 returns 3\r\n *   0.0034 returns 2\r\n *   120.5e+30 returns 4\r\n *\r\n * @param {number} value\r\n * @return {number} digits   Number of significant digits\r\n */\r\nexport function digits(value) {\r\n  return value.toExponential().replace(/e.*$/, '') // remove exponential notation\r\n  .replace(/^0\\.?0*|\\./, '') // remove decimal point and leading zeros\r\n  .length;\r\n}\r\n\r\n/**\r\n * Minimum number added to one that makes the result different than one\r\n */\r\nexport var DBL_EPSILON = Number.EPSILON || 2.2204460492503130808472633361816E-16;\r\n\r\n/**\r\n * Compares two floating point numbers.\r\n * @param {number} x          First value to compare\r\n * @param {number} y          Second value to compare\r\n * @param {number} [epsilon]  The maximum relative difference between x and y\r\n *                            If epsilon is undefined or null, the function will\r\n *                            test whether x and y are exactly equal.\r\n * @return {boolean} whether the two numbers are nearly equal\r\n*/\r\nexport function nearlyEqual(x, y, epsilon) {\r\n  // if epsilon is null or undefined, test whether x and y are exactly equal\r\n  if (epsilon === null || epsilon === undefined) {\r\n    return x === y;\r\n  }\r\n  if (x === y) {\r\n    return true;\r\n  }\r\n\r\n  // NaN\r\n  if (isNaN(x) || isNaN(y)) {\r\n    return false;\r\n  }\r\n\r\n  // at this point x and y should be finite\r\n  if (isFinite(x) && isFinite(y)) {\r\n    // check numbers are very close, needed when comparing numbers near zero\r\n    var diff = Math.abs(x - y);\r\n    if (diff < DBL_EPSILON) {\r\n      return true;\r\n    } else {\r\n      // use relative error\r\n      return diff <= Math.max(Math.abs(x), Math.abs(y)) * epsilon;\r\n    }\r\n  }\r\n\r\n  // Infinite and Number or negative Infinite and positive Infinite cases\r\n  return false;\r\n}\r\n\r\n/**\r\n * Calculate the hyperbolic arccos of a number\r\n * @param {number} x\r\n * @return {number}\r\n */\r\nexport var acosh = Math.acosh || function (x) {\r\n  return Math.log(Math.sqrt(x * x - 1) + x);\r\n};\r\nexport var asinh = Math.asinh || function (x) {\r\n  return Math.log(Math.sqrt(x * x + 1) + x);\r\n};\r\n\r\n/**\r\n * Calculate the hyperbolic arctangent of a number\r\n * @param {number} x\r\n * @return {number}\r\n */\r\nexport var atanh = Math.atanh || function (x) {\r\n  return Math.log((1 + x) / (1 - x)) / 2;\r\n};\r\n\r\n/**\r\n * Calculate the hyperbolic cosine of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\r\nexport var cosh = Math.cosh || function (x) {\r\n  return (Math.exp(x) + Math.exp(-x)) / 2;\r\n};\r\n\r\n/**\r\n * Calculate the hyperbolic sine of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\r\nexport var sinh = Math.sinh || function (x) {\r\n  return (Math.exp(x) - Math.exp(-x)) / 2;\r\n};\r\n\r\n/**\r\n * Calculate the hyperbolic tangent of a number\r\n * @param {number} x\r\n * @returns {number}\r\n */\r\nexport var tanh = Math.tanh || function (x) {\r\n  var e = Math.exp(2 * x);\r\n  return (e - 1) / (e + 1);\r\n};\r\n\r\n/**\r\n * Returns a value with the magnitude of x and the sign of y.\r\n * @param {number} x\r\n * @param {number} y\r\n * @returns {number}\r\n */\r\nexport function copysign(x, y) {\r\n  var signx = x > 0 ? true : x < 0 ? false : 1 / x === Infinity;\r\n  var signy = y > 0 ? true : y < 0 ? false : 1 / y === Infinity;\r\n  return signx ^ signy ? -x : x;\r\n}"]},"metadata":{},"sourceType":"module"}