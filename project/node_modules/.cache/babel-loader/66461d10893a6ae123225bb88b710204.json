{"ast":null,"code":"import { clone } from '../../../utils/object.js';\nexport function createRealSymmetric(_ref) {\n  var {\n    config,\n    addScalar,\n    subtract,\n    abs,\n    atan,\n    cos,\n    sin,\n    multiplyScalar,\n    inv,\n    bignumber,\n    multiply,\n    add\n  } = _ref;\n  /**\r\n   * @param {number[] | BigNumber[]} arr\r\n   * @param {number} N\r\n   * @param {number} prec\r\n   * @param {'number' | 'BigNumber'} type\r\n   */\n\n  function main(arr, N) {\n    var prec = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : config.epsilon;\n    var type = arguments.length > 3 ? arguments[3] : undefined;\n\n    if (type === 'number') {\n      return diag(arr, prec);\n    }\n\n    if (type === 'BigNumber') {\n      return diagBig(arr, prec);\n    }\n\n    throw TypeError('Unsupported data type: ' + type);\n  } // diagonalization implementation for number (efficient)\n\n\n  function diag(x, precision) {\n    var N = x.length;\n    var e0 = Math.abs(precision / N);\n    var psi;\n    var Sij = new Array(N); // Sij is Identity Matrix\n\n    for (var i = 0; i < N; i++) {\n      Sij[i] = createArray(N, 0);\n      Sij[i][i] = 1.0;\n    } // initial error\n\n\n    var Vab = getAij(x);\n\n    while (Math.abs(Vab[1]) >= Math.abs(e0)) {\n      var _i = Vab[0][0];\n      var j = Vab[0][1];\n      psi = getTheta(x[_i][_i], x[j][j], x[_i][j]);\n      x = x1(x, psi, _i, j);\n      Sij = Sij1(Sij, psi, _i, j);\n      Vab = getAij(x);\n    }\n\n    var Ei = createArray(N, 0); // eigenvalues\n\n    for (var _i2 = 0; _i2 < N; _i2++) {\n      Ei[_i2] = x[_i2][_i2];\n    }\n\n    return sorting(clone(Ei), clone(Sij));\n  } // diagonalization implementation for bigNumber\n\n\n  function diagBig(x, precision) {\n    var N = x.length;\n    var e0 = abs(precision / N);\n    var psi;\n    var Sij = new Array(N); // Sij is Identity Matrix\n\n    for (var i = 0; i < N; i++) {\n      Sij[i] = createArray(N, 0);\n      Sij[i][i] = 1.0;\n    } // initial error\n\n\n    var Vab = getAijBig(x);\n\n    while (abs(Vab[1]) >= abs(e0)) {\n      var _i3 = Vab[0][0];\n      var j = Vab[0][1];\n      psi = getThetaBig(x[_i3][_i3], x[j][j], x[_i3][j]);\n      x = x1Big(x, psi, _i3, j);\n      Sij = Sij1Big(Sij, psi, _i3, j);\n      Vab = getAijBig(x);\n    }\n\n    var Ei = createArray(N, 0); // eigenvalues\n\n    for (var _i4 = 0; _i4 < N; _i4++) {\n      Ei[_i4] = x[_i4][_i4];\n    } // return [clone(Ei), clone(Sij)]\n\n\n    return sorting(clone(Ei), clone(Sij));\n  } // get angle\n\n\n  function getTheta(aii, ajj, aij) {\n    var denom = ajj - aii;\n\n    if (Math.abs(denom) <= config.epsilon) {\n      return Math.PI / 4.0;\n    } else {\n      return 0.5 * Math.atan(2.0 * aij / (ajj - aii));\n    }\n  } // get angle\n\n\n  function getThetaBig(aii, ajj, aij) {\n    var denom = subtract(ajj, aii);\n\n    if (abs(denom) <= config.epsilon) {\n      return bignumber(-1).acos().div(4);\n    } else {\n      return multiplyScalar(0.5, atan(multiply(2.0, aij, inv(denom))));\n    }\n  } // update eigvec\n\n\n  function Sij1(Sij, theta, i, j) {\n    var N = Sij.length;\n    var c = Math.cos(theta);\n    var s = Math.sin(theta);\n    var Ski = createArray(N, 0);\n    var Skj = createArray(N, 0);\n\n    for (var k = 0; k < N; k++) {\n      Ski[k] = c * Sij[k][i] - s * Sij[k][j];\n      Skj[k] = s * Sij[k][i] + c * Sij[k][j];\n    }\n\n    for (var _k = 0; _k < N; _k++) {\n      Sij[_k][i] = Ski[_k];\n      Sij[_k][j] = Skj[_k];\n    }\n\n    return Sij;\n  } // update eigvec for overlap\n\n\n  function Sij1Big(Sij, theta, i, j) {\n    var N = Sij.length;\n    var c = cos(theta);\n    var s = sin(theta);\n    var Ski = createArray(N, bignumber(0));\n    var Skj = createArray(N, bignumber(0));\n\n    for (var k = 0; k < N; k++) {\n      Ski[k] = subtract(multiplyScalar(c, Sij[k][i]), multiplyScalar(s, Sij[k][j]));\n      Skj[k] = addScalar(multiplyScalar(s, Sij[k][i]), multiplyScalar(c, Sij[k][j]));\n    }\n\n    for (var _k2 = 0; _k2 < N; _k2++) {\n      Sij[_k2][i] = Ski[_k2];\n      Sij[_k2][j] = Skj[_k2];\n    }\n\n    return Sij;\n  } // update matrix\n\n\n  function x1Big(Hij, theta, i, j) {\n    var N = Hij.length;\n    var c = bignumber(cos(theta));\n    var s = bignumber(sin(theta));\n    var c2 = multiplyScalar(c, c);\n    var s2 = multiplyScalar(s, s);\n    var Aki = createArray(N, bignumber(0));\n    var Akj = createArray(N, bignumber(0)); // 2cs Hij\n\n    var csHij = multiply(bignumber(2), c, s, Hij[i][j]); //  Aii\n\n    var Aii = addScalar(subtract(multiplyScalar(c2, Hij[i][i]), csHij), multiplyScalar(s2, Hij[j][j]));\n    var Ajj = add(multiplyScalar(s2, Hij[i][i]), csHij, multiplyScalar(c2, Hij[j][j])); // 0  to i\n\n    for (var k = 0; k < N; k++) {\n      Aki[k] = subtract(multiplyScalar(c, Hij[i][k]), multiplyScalar(s, Hij[j][k]));\n      Akj[k] = addScalar(multiplyScalar(s, Hij[i][k]), multiplyScalar(c, Hij[j][k]));\n    } // Modify Hij\n\n\n    Hij[i][i] = Aii;\n    Hij[j][j] = Ajj;\n    Hij[i][j] = bignumber(0);\n    Hij[j][i] = bignumber(0); // 0  to i\n\n    for (var _k3 = 0; _k3 < N; _k3++) {\n      if (_k3 !== i && _k3 !== j) {\n        Hij[i][_k3] = Aki[_k3];\n        Hij[_k3][i] = Aki[_k3];\n        Hij[j][_k3] = Akj[_k3];\n        Hij[_k3][j] = Akj[_k3];\n      }\n    }\n\n    return Hij;\n  } // update matrix\n\n\n  function x1(Hij, theta, i, j) {\n    var N = Hij.length;\n    var c = Math.cos(theta);\n    var s = Math.sin(theta);\n    var c2 = c * c;\n    var s2 = s * s;\n    var Aki = createArray(N, 0);\n    var Akj = createArray(N, 0); //  Aii\n\n    var Aii = c2 * Hij[i][i] - 2 * c * s * Hij[i][j] + s2 * Hij[j][j];\n    var Ajj = s2 * Hij[i][i] + 2 * c * s * Hij[i][j] + c2 * Hij[j][j]; // 0  to i\n\n    for (var k = 0; k < N; k++) {\n      Aki[k] = c * Hij[i][k] - s * Hij[j][k];\n      Akj[k] = s * Hij[i][k] + c * Hij[j][k];\n    } // Modify Hij\n\n\n    Hij[i][i] = Aii;\n    Hij[j][j] = Ajj;\n    Hij[i][j] = 0;\n    Hij[j][i] = 0; // 0  to i\n\n    for (var _k4 = 0; _k4 < N; _k4++) {\n      if (_k4 !== i && _k4 !== j) {\n        Hij[i][_k4] = Aki[_k4];\n        Hij[_k4][i] = Aki[_k4];\n        Hij[j][_k4] = Akj[_k4];\n        Hij[_k4][j] = Akj[_k4];\n      }\n    }\n\n    return Hij;\n  } // get max off-diagonal value from Upper Diagonal\n\n\n  function getAij(Mij) {\n    var N = Mij.length;\n    var maxMij = 0;\n    var maxIJ = [0, 1];\n\n    for (var i = 0; i < N; i++) {\n      for (var j = i + 1; j < N; j++) {\n        if (Math.abs(maxMij) < Math.abs(Mij[i][j])) {\n          maxMij = Math.abs(Mij[i][j]);\n          maxIJ = [i, j];\n        }\n      }\n    }\n\n    return [maxIJ, maxMij];\n  } // get max off-diagonal value from Upper Diagonal\n\n\n  function getAijBig(Mij) {\n    var N = Mij.length;\n    var maxMij = 0;\n    var maxIJ = [0, 1];\n\n    for (var i = 0; i < N; i++) {\n      for (var j = i + 1; j < N; j++) {\n        if (abs(maxMij) < abs(Mij[i][j])) {\n          maxMij = abs(Mij[i][j]);\n          maxIJ = [i, j];\n        }\n      }\n    }\n\n    return [maxIJ, maxMij];\n  } // sort results\n\n\n  function sorting(E, S) {\n    var N = E.length;\n    var values = Array(N);\n    var vectors = Array(N);\n\n    for (var k = 0; k < N; k++) {\n      vectors[k] = Array(N);\n    }\n\n    for (var i = 0; i < N; i++) {\n      var minID = 0;\n      var minE = E[0];\n\n      for (var j = 0; j < E.length; j++) {\n        if (abs(E[j]) < abs(minE)) {\n          minID = j;\n          minE = E[minID];\n        }\n      }\n\n      values[i] = E.splice(minID, 1)[0];\n\n      for (var _k5 = 0; _k5 < N; _k5++) {\n        vectors[_k5][i] = S[_k5][minID];\n\n        S[_k5].splice(minID, 1);\n      }\n    }\n\n    return {\n      values,\n      vectors\n    };\n  }\n  /**\r\n   * Create an array of a certain size and fill all items with an initial value\r\n   * @param {number} size\r\n   * @param {number} value\r\n   * @return {number[]}\r\n   */\n\n\n  function createArray(size, value) {\n    // TODO: as soon as all browsers support Array.fill, use that instead (IE doesn't support it)\n    var array = new Array(size);\n\n    for (var i = 0; i < size; i++) {\n      array[i] = value;\n    }\n\n    return array;\n  }\n\n  return main;\n}","map":{"version":3,"sources":["C:/Users/x/Desktop/openDSA/openDSA_dashboard/project/node_modules/mathjs/lib/esm/function/matrix/eigs/realSymetric.js"],"names":["clone","createRealSymmetric","_ref","config","addScalar","subtract","abs","atan","cos","sin","multiplyScalar","inv","bignumber","multiply","add","main","arr","N","prec","arguments","length","undefined","epsilon","type","diag","diagBig","TypeError","x","precision","e0","Math","psi","Sij","Array","i","createArray","Vab","getAij","_i","j","getTheta","x1","Sij1","Ei","_i2","sorting","getAijBig","_i3","getThetaBig","x1Big","Sij1Big","_i4","aii","ajj","aij","denom","PI","acos","div","theta","c","s","Ski","Skj","k","_k","_k2","Hij","c2","s2","Aki","Akj","csHij","Aii","Ajj","_k3","_k4","Mij","maxMij","maxIJ","E","S","values","vectors","minID","minE","splice","_k5","size","value","array"],"mappings":"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","sourcesContent":["import { clone } from '../../../utils/object.js';\r\nexport function createRealSymmetric(_ref) {\r\n  var {\r\n    config,\r\n    addScalar,\r\n    subtract,\r\n    abs,\r\n    atan,\r\n    cos,\r\n    sin,\r\n    multiplyScalar,\r\n    inv,\r\n    bignumber,\r\n    multiply,\r\n    add\r\n  } = _ref;\r\n  /**\r\n   * @param {number[] | BigNumber[]} arr\r\n   * @param {number} N\r\n   * @param {number} prec\r\n   * @param {'number' | 'BigNumber'} type\r\n   */\r\n  function main(arr, N) {\r\n    var prec = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : config.epsilon;\r\n    var type = arguments.length > 3 ? arguments[3] : undefined;\r\n    if (type === 'number') {\r\n      return diag(arr, prec);\r\n    }\r\n    if (type === 'BigNumber') {\r\n      return diagBig(arr, prec);\r\n    }\r\n    throw TypeError('Unsupported data type: ' + type);\r\n  }\r\n\r\n  // diagonalization implementation for number (efficient)\r\n  function diag(x, precision) {\r\n    var N = x.length;\r\n    var e0 = Math.abs(precision / N);\r\n    var psi;\r\n    var Sij = new Array(N);\r\n    // Sij is Identity Matrix\r\n    for (var i = 0; i < N; i++) {\r\n      Sij[i] = createArray(N, 0);\r\n      Sij[i][i] = 1.0;\r\n    }\r\n    // initial error\r\n    var Vab = getAij(x);\r\n    while (Math.abs(Vab[1]) >= Math.abs(e0)) {\r\n      var _i = Vab[0][0];\r\n      var j = Vab[0][1];\r\n      psi = getTheta(x[_i][_i], x[j][j], x[_i][j]);\r\n      x = x1(x, psi, _i, j);\r\n      Sij = Sij1(Sij, psi, _i, j);\r\n      Vab = getAij(x);\r\n    }\r\n    var Ei = createArray(N, 0); // eigenvalues\r\n    for (var _i2 = 0; _i2 < N; _i2++) {\r\n      Ei[_i2] = x[_i2][_i2];\r\n    }\r\n    return sorting(clone(Ei), clone(Sij));\r\n  }\r\n\r\n  // diagonalization implementation for bigNumber\r\n  function diagBig(x, precision) {\r\n    var N = x.length;\r\n    var e0 = abs(precision / N);\r\n    var psi;\r\n    var Sij = new Array(N);\r\n    // Sij is Identity Matrix\r\n    for (var i = 0; i < N; i++) {\r\n      Sij[i] = createArray(N, 0);\r\n      Sij[i][i] = 1.0;\r\n    }\r\n    // initial error\r\n    var Vab = getAijBig(x);\r\n    while (abs(Vab[1]) >= abs(e0)) {\r\n      var _i3 = Vab[0][0];\r\n      var j = Vab[0][1];\r\n      psi = getThetaBig(x[_i3][_i3], x[j][j], x[_i3][j]);\r\n      x = x1Big(x, psi, _i3, j);\r\n      Sij = Sij1Big(Sij, psi, _i3, j);\r\n      Vab = getAijBig(x);\r\n    }\r\n    var Ei = createArray(N, 0); // eigenvalues\r\n    for (var _i4 = 0; _i4 < N; _i4++) {\r\n      Ei[_i4] = x[_i4][_i4];\r\n    }\r\n    // return [clone(Ei), clone(Sij)]\r\n    return sorting(clone(Ei), clone(Sij));\r\n  }\r\n\r\n  // get angle\r\n  function getTheta(aii, ajj, aij) {\r\n    var denom = ajj - aii;\r\n    if (Math.abs(denom) <= config.epsilon) {\r\n      return Math.PI / 4.0;\r\n    } else {\r\n      return 0.5 * Math.atan(2.0 * aij / (ajj - aii));\r\n    }\r\n  }\r\n\r\n  // get angle\r\n  function getThetaBig(aii, ajj, aij) {\r\n    var denom = subtract(ajj, aii);\r\n    if (abs(denom) <= config.epsilon) {\r\n      return bignumber(-1).acos().div(4);\r\n    } else {\r\n      return multiplyScalar(0.5, atan(multiply(2.0, aij, inv(denom))));\r\n    }\r\n  }\r\n\r\n  // update eigvec\r\n  function Sij1(Sij, theta, i, j) {\r\n    var N = Sij.length;\r\n    var c = Math.cos(theta);\r\n    var s = Math.sin(theta);\r\n    var Ski = createArray(N, 0);\r\n    var Skj = createArray(N, 0);\r\n    for (var k = 0; k < N; k++) {\r\n      Ski[k] = c * Sij[k][i] - s * Sij[k][j];\r\n      Skj[k] = s * Sij[k][i] + c * Sij[k][j];\r\n    }\r\n    for (var _k = 0; _k < N; _k++) {\r\n      Sij[_k][i] = Ski[_k];\r\n      Sij[_k][j] = Skj[_k];\r\n    }\r\n    return Sij;\r\n  }\r\n  // update eigvec for overlap\r\n  function Sij1Big(Sij, theta, i, j) {\r\n    var N = Sij.length;\r\n    var c = cos(theta);\r\n    var s = sin(theta);\r\n    var Ski = createArray(N, bignumber(0));\r\n    var Skj = createArray(N, bignumber(0));\r\n    for (var k = 0; k < N; k++) {\r\n      Ski[k] = subtract(multiplyScalar(c, Sij[k][i]), multiplyScalar(s, Sij[k][j]));\r\n      Skj[k] = addScalar(multiplyScalar(s, Sij[k][i]), multiplyScalar(c, Sij[k][j]));\r\n    }\r\n    for (var _k2 = 0; _k2 < N; _k2++) {\r\n      Sij[_k2][i] = Ski[_k2];\r\n      Sij[_k2][j] = Skj[_k2];\r\n    }\r\n    return Sij;\r\n  }\r\n\r\n  // update matrix\r\n  function x1Big(Hij, theta, i, j) {\r\n    var N = Hij.length;\r\n    var c = bignumber(cos(theta));\r\n    var s = bignumber(sin(theta));\r\n    var c2 = multiplyScalar(c, c);\r\n    var s2 = multiplyScalar(s, s);\r\n    var Aki = createArray(N, bignumber(0));\r\n    var Akj = createArray(N, bignumber(0));\r\n    // 2cs Hij\r\n    var csHij = multiply(bignumber(2), c, s, Hij[i][j]);\r\n    //  Aii\r\n    var Aii = addScalar(subtract(multiplyScalar(c2, Hij[i][i]), csHij), multiplyScalar(s2, Hij[j][j]));\r\n    var Ajj = add(multiplyScalar(s2, Hij[i][i]), csHij, multiplyScalar(c2, Hij[j][j]));\r\n    // 0  to i\r\n    for (var k = 0; k < N; k++) {\r\n      Aki[k] = subtract(multiplyScalar(c, Hij[i][k]), multiplyScalar(s, Hij[j][k]));\r\n      Akj[k] = addScalar(multiplyScalar(s, Hij[i][k]), multiplyScalar(c, Hij[j][k]));\r\n    }\r\n    // Modify Hij\r\n    Hij[i][i] = Aii;\r\n    Hij[j][j] = Ajj;\r\n    Hij[i][j] = bignumber(0);\r\n    Hij[j][i] = bignumber(0);\r\n    // 0  to i\r\n    for (var _k3 = 0; _k3 < N; _k3++) {\r\n      if (_k3 !== i && _k3 !== j) {\r\n        Hij[i][_k3] = Aki[_k3];\r\n        Hij[_k3][i] = Aki[_k3];\r\n        Hij[j][_k3] = Akj[_k3];\r\n        Hij[_k3][j] = Akj[_k3];\r\n      }\r\n    }\r\n    return Hij;\r\n  }\r\n\r\n  // update matrix\r\n  function x1(Hij, theta, i, j) {\r\n    var N = Hij.length;\r\n    var c = Math.cos(theta);\r\n    var s = Math.sin(theta);\r\n    var c2 = c * c;\r\n    var s2 = s * s;\r\n    var Aki = createArray(N, 0);\r\n    var Akj = createArray(N, 0);\r\n    //  Aii\r\n    var Aii = c2 * Hij[i][i] - 2 * c * s * Hij[i][j] + s2 * Hij[j][j];\r\n    var Ajj = s2 * Hij[i][i] + 2 * c * s * Hij[i][j] + c2 * Hij[j][j];\r\n    // 0  to i\r\n    for (var k = 0; k < N; k++) {\r\n      Aki[k] = c * Hij[i][k] - s * Hij[j][k];\r\n      Akj[k] = s * Hij[i][k] + c * Hij[j][k];\r\n    }\r\n    // Modify Hij\r\n    Hij[i][i] = Aii;\r\n    Hij[j][j] = Ajj;\r\n    Hij[i][j] = 0;\r\n    Hij[j][i] = 0;\r\n    // 0  to i\r\n    for (var _k4 = 0; _k4 < N; _k4++) {\r\n      if (_k4 !== i && _k4 !== j) {\r\n        Hij[i][_k4] = Aki[_k4];\r\n        Hij[_k4][i] = Aki[_k4];\r\n        Hij[j][_k4] = Akj[_k4];\r\n        Hij[_k4][j] = Akj[_k4];\r\n      }\r\n    }\r\n    return Hij;\r\n  }\r\n\r\n  // get max off-diagonal value from Upper Diagonal\r\n  function getAij(Mij) {\r\n    var N = Mij.length;\r\n    var maxMij = 0;\r\n    var maxIJ = [0, 1];\r\n    for (var i = 0; i < N; i++) {\r\n      for (var j = i + 1; j < N; j++) {\r\n        if (Math.abs(maxMij) < Math.abs(Mij[i][j])) {\r\n          maxMij = Math.abs(Mij[i][j]);\r\n          maxIJ = [i, j];\r\n        }\r\n      }\r\n    }\r\n    return [maxIJ, maxMij];\r\n  }\r\n\r\n  // get max off-diagonal value from Upper Diagonal\r\n  function getAijBig(Mij) {\r\n    var N = Mij.length;\r\n    var maxMij = 0;\r\n    var maxIJ = [0, 1];\r\n    for (var i = 0; i < N; i++) {\r\n      for (var j = i + 1; j < N; j++) {\r\n        if (abs(maxMij) < abs(Mij[i][j])) {\r\n          maxMij = abs(Mij[i][j]);\r\n          maxIJ = [i, j];\r\n        }\r\n      }\r\n    }\r\n    return [maxIJ, maxMij];\r\n  }\r\n\r\n  // sort results\r\n  function sorting(E, S) {\r\n    var N = E.length;\r\n    var values = Array(N);\r\n    var vectors = Array(N);\r\n    for (var k = 0; k < N; k++) {\r\n      vectors[k] = Array(N);\r\n    }\r\n    for (var i = 0; i < N; i++) {\r\n      var minID = 0;\r\n      var minE = E[0];\r\n      for (var j = 0; j < E.length; j++) {\r\n        if (abs(E[j]) < abs(minE)) {\r\n          minID = j;\r\n          minE = E[minID];\r\n        }\r\n      }\r\n      values[i] = E.splice(minID, 1)[0];\r\n      for (var _k5 = 0; _k5 < N; _k5++) {\r\n        vectors[_k5][i] = S[_k5][minID];\r\n        S[_k5].splice(minID, 1);\r\n      }\r\n    }\r\n    return {\r\n      values,\r\n      vectors\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Create an array of a certain size and fill all items with an initial value\r\n   * @param {number} size\r\n   * @param {number} value\r\n   * @return {number[]}\r\n   */\r\n  function createArray(size, value) {\r\n    // TODO: as soon as all browsers support Array.fill, use that instead (IE doesn't support it)\r\n    var array = new Array(size);\r\n    for (var i = 0; i < size; i++) {\r\n      array[i] = value;\r\n    }\r\n    return array;\r\n  }\r\n  return main;\r\n}"]},"metadata":{},"sourceType":"module"}