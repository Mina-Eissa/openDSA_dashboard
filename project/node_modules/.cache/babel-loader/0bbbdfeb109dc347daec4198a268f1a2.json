{"ast":null,"code":"/* eslint-disable @typescript-eslint/no-inferrable-types */\nimport { print as printWindow, createElement, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { SvgRenderer } from '@syncfusion/ej2-svg-base';\nimport { getElement, removeElement } from '../utils/helper';\nimport { beforePrint, afterExport } from '../model/constants';\nimport { PdfPageOrientation, PdfDocument, PdfBitmap, SizeF, PdfStandardFont, PdfPageTemplateElement, PdfSolidBrush, PdfColor } from '@syncfusion/ej2-pdf-export';\n\nvar ExportUtils =\n/** @class */\nfunction () {\n  /**\r\n   * Constructor for chart and accumulation annotation\r\n   *\r\n   * @param control\r\n   */\n  function ExportUtils(control) {\n    this.control = control;\n  }\n  /**\r\n   * To print the accumulation and chart elements\r\n   *\r\n   * @param elements\r\n   */\n\n\n  ExportUtils.prototype.print = function (elements) {\n    this.printWindow = window.open('', 'print', 'height=' + window.outerHeight + ',width=' + window.outerWidth + ',tabbar=no');\n    this.printWindow.moveTo(0, 0);\n    this.printWindow.resizeTo(screen.availWidth, screen.availHeight);\n    var argsData = {\n      cancel: false,\n      htmlContent: this.getHTMLContent(elements),\n      name: beforePrint\n    };\n    this.control.trigger(beforePrint, argsData);\n\n    if (!argsData.cancel) {\n      printWindow(argsData.htmlContent, this.printWindow);\n    }\n  };\n  /**\r\n   * To get the html string of the chart and accumulation\r\n   *\r\n   * @param elements\r\n   * @private\r\n   */\n\n\n  ExportUtils.prototype.getHTMLContent = function (elements) {\n    var div = createElement('div');\n\n    if (elements) {\n      if (elements instanceof Array) {\n        for (var j = 0; j < elements.length; j++) {\n          var value = elements[j];\n          div.appendChild(getElement(value).cloneNode(true));\n        }\n      } else if (elements instanceof Element) {\n        div.appendChild(elements.cloneNode(true));\n      } else {\n        div.appendChild(getElement(elements).cloneNode(true));\n      }\n    } else {\n      div.appendChild(this.control.element.cloneNode(true));\n    }\n\n    return div;\n  };\n  /**\r\n   * To export the file as image/svg format\r\n   *\r\n   * @param type\r\n   * @param fileName\r\n   */\n\n\n  ExportUtils.prototype.export = function (type, fileName, orientation, controls, width, height, isVertical, header, footer) {\n    var _this = this;\n\n    var controlValue = this.getControlsValue(controls, isVertical);\n    width = width ? width : controlValue.width;\n    height = height ? height : controlValue.height;\n    var element = this.control.svgObject;\n    var isCanvas = this.control.enableCanvas;\n    var image;\n\n    if (!isCanvas) {\n      element = createElement('canvas', {\n        id: 'ej2-canvas',\n        attrs: {\n          'width': width.toString(),\n          'height': height.toString()\n        }\n      });\n    }\n\n    var isDownload = !(Browser.userAgent.toString().indexOf('HeadlessChrome') > -1);\n    orientation = isNullOrUndefined(orientation) ? PdfPageOrientation.Landscape : orientation;\n    var svgData = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">' + controlValue.svg.outerHTML + '</svg>';\n    var url = window.URL.createObjectURL(new Blob(type === 'SVG' ? [svgData] : [new XMLSerializer().serializeToString(controlValue.svg)], {\n      type: 'image/svg+xml'\n    }));\n\n    if (type === 'SVG') {\n      if (Browser.info.name === 'msie') {\n        var svg = new Blob([new XMLSerializer().serializeToString(controlValue.svg)], {\n          type: 'application/octet-stream'\n        });\n        window.navigator.msSaveOrOpenBlob(svg, fileName + '.' + type.toLocaleLowerCase());\n      } else {\n        this.triggerDownload(fileName, type, url, isDownload);\n      }\n    } else if (Browser.info.name === 'msie') {\n      var canvas = element;\n\n      if (!isCanvas) {\n        canvas = this.createCanvas();\n      }\n\n      image = canvas.toDataURL();\n\n      if (type === 'PDF') {\n        this.exportPdf(canvas, orientation, width, height, isDownload, fileName, header, footer);\n      } else {\n        this.doexport(type, image, fileName);\n      }\n    } else {\n      var image_1 = new Image();\n      var ctx_1 = element.getContext('2d');\n\n      image_1.onload = function () {\n        ctx_1.drawImage(image_1, 0, 0);\n        window.URL.revokeObjectURL(url);\n\n        if (type === 'PDF') {\n          _this.exportPdf(element, orientation, width, height, isDownload, fileName, header, footer);\n        } else {\n          if (window.navigator.msSaveOrOpenBlob) {\n            window.navigator.msSaveOrOpenBlob(element.toBlob(null), fileName + '.' + type.toLocaleLowerCase());\n          } else {\n            _this.triggerDownload(fileName, type, element.toDataURL('image/' + type.toLowerCase()), isDownload);\n          }\n        }\n      };\n\n      image_1.src = url;\n    }\n\n    if (!isCanvas) {\n      removeElement(document.getElementById(this.control.element.id + '_canvas'));\n    }\n  };\n  /**\r\n   * To get data url for charts.\r\n   *\r\n   * @param chart\r\n   */\n\n\n  ExportUtils.prototype.getDataUrl = function (chart) {\n    var controlValue = this.getControlsValue([chart]);\n    var element = this.control.svgObject;\n    var isCanvas = this.control.enableCanvas;\n\n    if (!isCanvas) {\n      element = createElement('canvas', {\n        id: 'ej2-canvas',\n        attrs: {\n          'width': controlValue.width.toString(),\n          'height': controlValue.height.toString()\n        }\n      });\n    }\n\n    var url = window.URL.createObjectURL(new Blob([new XMLSerializer().serializeToString(controlValue.svg)], {\n      type: 'image/svg+xml'\n    }));\n\n    if (Browser.info.name === 'msie') {\n      var canvas = element;\n\n      if (!isCanvas) {\n        canvas = this.createCanvas();\n      }\n\n      var argsData = {\n        name: afterExport,\n        cancel: false,\n        dataUrl: element.toDataURL('image/png')\n      };\n      chart.trigger(afterExport, argsData);\n      return {\n        element: canvas,\n        dataUrl: canvas.toDataURL()\n      };\n    } else {\n      var image_2 = new Image();\n      var ctx_2 = element.getContext('2d');\n\n      image_2.onload = function () {\n        ctx_2.drawImage(image_2, 0, 0);\n        window.URL.revokeObjectURL(url);\n        var argsData = {\n          name: afterExport,\n          cancel: false,\n          dataUrl: element.toDataURL('image/png')\n        };\n        chart.trigger(afterExport, argsData);\n        return argsData.dataUrl;\n      };\n\n      image_2.src = url;\n      return {\n        element: element,\n        blobUrl: url\n      };\n    }\n  };\n  /**\r\n   * To trigger the download element\r\n   *\r\n   * @param fileName\r\n   * @param type\r\n   * @param url\r\n   */\n\n\n  ExportUtils.prototype.triggerDownload = function (fileName, type, url, isDownload) {\n    createElement('a', {\n      attrs: {\n        'download': fileName + '.' + type.toLocaleLowerCase(),\n        'href': url\n      }\n    }).dispatchEvent(new MouseEvent(isDownload ? 'click' : 'move', {\n      view: window,\n      bubbles: false,\n      cancelable: true\n    }));\n  };\n  /**\r\n   * To get the maximum size value\r\n   *\r\n   * @param controls\r\n   * @param name\r\n   */\n  // eslint-disable-next-line max-len\n\n\n  ExportUtils.prototype.getControlsValue = function (controls, isVertical) {\n    var width = 0;\n    var height = 0;\n    var isCanvas = this.control.enableCanvas;\n    var svgObject = new SvgRenderer('').createSvg({\n      id: 'Svg_Export_Element',\n      width: 200,\n      height: 200\n    });\n    controls.map(function (control) {\n      var svg = control.svgObject.cloneNode(true);\n      var groupEle = control.renderer.createGroup({\n        style: isNullOrUndefined(isVertical) || isVertical ? 'transform: translateY(' + height + 'px)' : 'transform: translateX(' + width + 'px)'\n      });\n      var backgroundColor = svg.childNodes[0] ? svg.childNodes[0].getAttribute('fill') : 'transparent';\n\n      if ((control.theme === 'Tailwind' || control.theme === 'TailwindDark') && (backgroundColor === 'rgba(255,255,255, 0.0)' || backgroundColor === 'transparent')) {\n        svg.childNodes[0].setAttribute('fill', 'rgba(255,255,255, 1)');\n      }\n\n      if (!isCanvas) {\n        groupEle.appendChild(svg);\n      }\n\n      var top = 0;\n      var left = 0;\n\n      if (control.stockLegendModule && control.legendSettings.visible) {\n        if (control.legendSettings.position === \"Bottom\" || control.legendSettings.position === \"Top\" || control.legendSettings.position === \"Auto\") {\n          top += control.stockLegendModule.legendBounds.height;\n        } else if (control.legendSettings.position === \"Left\" || control.legendSettings.position === \"Right\") {\n          left += control.stockLegendModule.legendBounds.width;\n        }\n      }\n\n      width = isNullOrUndefined(isVertical) || isVertical ? Math.max(control.availableSize.width + left, width) : width + control.availableSize.width + left;\n      height = isNullOrUndefined(isVertical) || isVertical ? height + control.availableSize.height + top : Math.max(control.availableSize.height + top, height);\n\n      if (!isCanvas) {\n        svgObject.appendChild(groupEle);\n      }\n    });\n\n    if (!isCanvas) {\n      svgObject.setAttribute('width', width + '');\n      svgObject.setAttribute('height', height + '');\n    }\n\n    return {\n      'width': width,\n      'height': height,\n      'svg': svgObject\n    };\n  };\n\n  ExportUtils.prototype.createCanvas = function () {\n    var chart = this.control;\n    this.canvasRender(true, chart);\n    var canvas = chart.svgObject;\n    this.canvasRender(false, chart);\n    return canvas;\n  };\n  /**\r\n   * To convert svg chart into canvas chart to fix export issue in IE\r\n   * We cant export svg to other formats in IE\r\n   *\r\n   * @param enableCanvas\r\n   * @param chart\r\n   * @param enableCanvas\r\n   * @param chart\r\n   */\n\n\n  ExportUtils.prototype.canvasRender = function (enableCanvas, chart) {\n    chart.enableCanvas = enableCanvas;\n    chart['preRender']();\n    chart['render']();\n  }; // eslint-disable-next-line max-len\n\n\n  ExportUtils.prototype.exportPdf = function (element, orientation, width, height, isDownload, fileName, header, footer) {\n    var document = new PdfDocument();\n    var margin = document.pageSettings.margins;\n    var pdfDefaultWidth = document.pageSettings.width;\n    var pdfDefaultHeight = document.pageSettings.height;\n    var imageString = element.toDataURL('image/jpeg').replace('image/jpeg', 'image/octet-stream');\n    document.pageSettings.orientation = orientation;\n    var exactWidth = pdfDefaultWidth < width ? width + margin.left + margin.right : pdfDefaultWidth;\n    var exactHeight = pdfDefaultHeight < height ? height + margin.top + margin.bottom : pdfDefaultHeight;\n\n    if (header !== undefined) {\n      var font = new PdfStandardFont(1, header.fontSize || 15);\n      var pdfHeader = new PdfPageTemplateElement(exactWidth, 40);\n      pdfHeader.graphics.drawString(header.content + '', font, null, new PdfSolidBrush(new PdfColor(0, 0, 0)), header.x, header.y, null);\n      document.template.top = pdfHeader;\n    }\n\n    if (footer !== undefined) {\n      var font = new PdfStandardFont(1, footer.fontSize || 15);\n      var pdfFooter = new PdfPageTemplateElement(exactWidth, 40);\n      pdfFooter.graphics.drawString(footer.content + '', font, null, new PdfSolidBrush(new PdfColor(0, 0, 0)), footer.x, footer.y, null);\n      document.template.bottom = pdfFooter;\n    }\n\n    document.pageSettings.size = new SizeF(exactWidth, exactHeight);\n    imageString = imageString.slice(imageString.indexOf(',') + 1);\n    document.pages.add().graphics.drawImage(new PdfBitmap(imageString), 0, 0, width, height);\n\n    if (isDownload) {\n      document.save(fileName + '.pdf');\n      document.destroy();\n    }\n  };\n\n  ExportUtils.prototype.doexport = function (type, image, fileName) {\n    var images = [];\n    var fileType = type || 'JPG';\n    images = [image];\n    this.exportImage(images, fileName, fileType, image);\n  };\n\n  ExportUtils.prototype.exportImage = function (images, fileName, fileType, image) {\n    var buffers = [];\n    var length = !(images instanceof HTMLElement) ? images.length : 0;\n\n    for (var g = 0; g < length; g++) {\n      image = images[g];\n      image = image.replace(/^data:[a-z]*;,/, '');\n      var image1 = image.split(',');\n      var byteString = atob(image1[1]);\n      var buffer = new ArrayBuffer(byteString.length);\n      var intArray = new Uint8Array(buffer);\n\n      for (var i = 0; i < byteString.length; i++) {\n        intArray[i] = byteString.charCodeAt(i);\n      }\n\n      buffers.push(buffer);\n    }\n\n    for (var j = 0; j < buffers.length; j++) {\n      var b = new Blob([buffers[j]], {\n        type: 'application/octet-stream'\n      });\n\n      if (Browser.info.name === 'msie') {\n        window.navigator.msSaveOrOpenBlob(b, fileName + '.' + fileType.toLocaleLowerCase());\n      }\n    }\n  };\n\n  return ExportUtils;\n}();\n\nexport { ExportUtils };","map":{"version":3,"sources":["C:/Users/x/Desktop/openDSA/openDSA_dashboard/project/node_modules/@syncfusion/ej2-react-charts/node_modules/@syncfusion/ej2-charts/src/common/utils/export.js"],"names":["print","printWindow","createElement","isNullOrUndefined","Browser","SvgRenderer","getElement","removeElement","beforePrint","afterExport","PdfPageOrientation","PdfDocument","PdfBitmap","SizeF","PdfStandardFont","PdfPageTemplateElement","PdfSolidBrush","PdfColor","ExportUtils","control","prototype","elements","window","open","outerHeight","outerWidth","moveTo","resizeTo","screen","availWidth","availHeight","argsData","cancel","htmlContent","getHTMLContent","name","trigger","div","Array","j","length","value","appendChild","cloneNode","Element","element","export","type","fileName","orientation","controls","width","height","isVertical","header","footer","_this","controlValue","getControlsValue","svgObject","isCanvas","enableCanvas","image","id","attrs","toString","isDownload","userAgent","indexOf","Landscape","svgData","svg","outerHTML","url","URL","createObjectURL","Blob","XMLSerializer","serializeToString","info","navigator","msSaveOrOpenBlob","toLocaleLowerCase","triggerDownload","canvas","createCanvas","toDataURL","exportPdf","doexport","image_1","Image","ctx_1","getContext","onload","drawImage","revokeObjectURL","toBlob","toLowerCase","src","document","getElementById","getDataUrl","chart","dataUrl","image_2","ctx_2","blobUrl","dispatchEvent","MouseEvent","view","bubbles","cancelable","createSvg","map","groupEle","renderer","createGroup","style","backgroundColor","childNodes","getAttribute","theme","setAttribute","top","left","stockLegendModule","legendSettings","visible","position","legendBounds","Math","max","availableSize","canvasRender","margin","pageSettings","margins","pdfDefaultWidth","pdfDefaultHeight","imageString","replace","exactWidth","right","exactHeight","bottom","undefined","font","fontSize","pdfHeader","graphics","drawString","content","x","y","template","pdfFooter","size","slice","pages","add","save","destroy","images","fileType","exportImage","buffers","HTMLElement","g","image1","split","byteString","atob","buffer","ArrayBuffer","intArray","Uint8Array","i","charCodeAt","push","b"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/no-inferrable-types */\r\nimport { print as printWindow, createElement, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\r\nimport { SvgRenderer } from '@syncfusion/ej2-svg-base';\r\nimport { getElement, removeElement } from '../utils/helper';\r\nimport { beforePrint, afterExport } from '../model/constants';\r\nimport { PdfPageOrientation, PdfDocument, PdfBitmap, SizeF, PdfStandardFont, PdfPageTemplateElement, PdfSolidBrush, PdfColor } from '@syncfusion/ej2-pdf-export';\r\nvar ExportUtils = /** @class */ (function () {\r\n    /**\r\n     * Constructor for chart and accumulation annotation\r\n     *\r\n     * @param control\r\n     */\r\n    function ExportUtils(control) {\r\n        this.control = control;\r\n    }\r\n    /**\r\n     * To print the accumulation and chart elements\r\n     *\r\n     * @param elements\r\n     */\r\n    ExportUtils.prototype.print = function (elements) {\r\n        this.printWindow = window.open('', 'print', 'height=' + window.outerHeight + ',width=' + window.outerWidth + ',tabbar=no');\r\n        this.printWindow.moveTo(0, 0);\r\n        this.printWindow.resizeTo(screen.availWidth, screen.availHeight);\r\n        var argsData = {\r\n            cancel: false, htmlContent: this.getHTMLContent(elements), name: beforePrint\r\n        };\r\n        this.control.trigger(beforePrint, argsData);\r\n        if (!argsData.cancel) {\r\n            printWindow(argsData.htmlContent, this.printWindow);\r\n        }\r\n    };\r\n    /**\r\n     * To get the html string of the chart and accumulation\r\n     *\r\n     * @param elements\r\n     * @private\r\n     */\r\n    ExportUtils.prototype.getHTMLContent = function (elements) {\r\n        var div = createElement('div');\r\n        if (elements) {\r\n            if (elements instanceof Array) {\r\n                for (var j = 0; j < elements.length; j++) {\r\n                    var value = elements[j];\r\n                    div.appendChild(getElement(value).cloneNode(true));\r\n                }\r\n            }\r\n            else if (elements instanceof Element) {\r\n                div.appendChild(elements.cloneNode(true));\r\n            }\r\n            else {\r\n                div.appendChild(getElement(elements).cloneNode(true));\r\n            }\r\n        }\r\n        else {\r\n            div.appendChild(this.control.element.cloneNode(true));\r\n        }\r\n        return div;\r\n    };\r\n    /**\r\n     * To export the file as image/svg format\r\n     *\r\n     * @param type\r\n     * @param fileName\r\n     */\r\n    ExportUtils.prototype.export = function (type, fileName, orientation, controls, width, height, isVertical, header, footer) {\r\n        var _this = this;\r\n        var controlValue = this.getControlsValue(controls, isVertical);\r\n        width = width ? width : controlValue.width;\r\n        height = height ? height : controlValue.height;\r\n        var element = this.control.svgObject;\r\n        var isCanvas = this.control.enableCanvas;\r\n        var image;\r\n        if (!isCanvas) {\r\n            element = createElement('canvas', {\r\n                id: 'ej2-canvas',\r\n                attrs: {\r\n                    'width': width.toString(),\r\n                    'height': height.toString()\r\n                }\r\n            });\r\n        }\r\n        var isDownload = !(Browser.userAgent.toString().indexOf('HeadlessChrome') > -1);\r\n        orientation = isNullOrUndefined(orientation) ? PdfPageOrientation.Landscape : orientation;\r\n        var svgData = '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">' +\r\n            controlValue.svg.outerHTML +\r\n            '</svg>';\r\n        var url = window.URL.createObjectURL(new Blob(type === 'SVG' ? [svgData] :\r\n            [(new XMLSerializer()).serializeToString(controlValue.svg)], { type: 'image/svg+xml' }));\r\n        if (type === 'SVG') {\r\n            if (Browser.info.name === 'msie') {\r\n                var svg = new Blob([(new XMLSerializer()).serializeToString(controlValue.svg)], { type: 'application/octet-stream' });\r\n                window.navigator.msSaveOrOpenBlob(svg, fileName + '.' + type.toLocaleLowerCase());\r\n            }\r\n            else {\r\n                this.triggerDownload(fileName, type, url, isDownload);\r\n            }\r\n        }\r\n        else if (Browser.info.name === 'msie') {\r\n            var canvas = element;\r\n            if (!isCanvas) {\r\n                canvas = this.createCanvas();\r\n            }\r\n            image = canvas.toDataURL();\r\n            if (type === 'PDF') {\r\n                this.exportPdf(canvas, orientation, width, height, isDownload, fileName, header, footer);\r\n            }\r\n            else {\r\n                this.doexport(type, image, fileName);\r\n            }\r\n        }\r\n        else {\r\n            var image_1 = new Image();\r\n            var ctx_1 = element.getContext('2d');\r\n            image_1.onload = (function () {\r\n                ctx_1.drawImage(image_1, 0, 0);\r\n                window.URL.revokeObjectURL(url);\r\n                if (type === 'PDF') {\r\n                    _this.exportPdf(element, orientation, width, height, isDownload, fileName, header, footer);\r\n                }\r\n                else {\r\n                    if (window.navigator.msSaveOrOpenBlob) {\r\n                        window.navigator.msSaveOrOpenBlob(element.toBlob(null), fileName + '.' + type.toLocaleLowerCase());\r\n                    }\r\n                    else {\r\n                        _this.triggerDownload(fileName, type, element.toDataURL('image/' + type.toLowerCase()), isDownload);\r\n                    }\r\n                }\r\n            });\r\n            image_1.src = url;\r\n        }\r\n        if (!isCanvas) {\r\n            removeElement(document.getElementById(this.control.element.id + '_canvas'));\r\n        }\r\n    };\r\n    /**\r\n     * To get data url for charts.\r\n     *\r\n     * @param chart\r\n     */\r\n    ExportUtils.prototype.getDataUrl = function (chart) {\r\n        var controlValue = this.getControlsValue([chart]);\r\n        var element = this.control.svgObject;\r\n        var isCanvas = this.control.enableCanvas;\r\n        if (!isCanvas) {\r\n            element = createElement('canvas', {\r\n                id: 'ej2-canvas',\r\n                attrs: {\r\n                    'width': controlValue.width.toString(),\r\n                    'height': controlValue.height.toString()\r\n                }\r\n            });\r\n        }\r\n        var url = window.URL.createObjectURL(new Blob([(new XMLSerializer()).serializeToString(controlValue.svg)], { type: 'image/svg+xml' }));\r\n        if (Browser.info.name === 'msie') {\r\n            var canvas = element;\r\n            if (!isCanvas) {\r\n                canvas = this.createCanvas();\r\n            }\r\n            var argsData = {\r\n                name: afterExport, cancel: false, dataUrl: element.toDataURL('image/png')\r\n            };\r\n            chart.trigger(afterExport, argsData);\r\n            return { element: canvas, dataUrl: canvas.toDataURL() };\r\n        }\r\n        else {\r\n            var image_2 = new Image();\r\n            var ctx_2 = element.getContext('2d');\r\n            image_2.onload = (function () {\r\n                ctx_2.drawImage(image_2, 0, 0);\r\n                window.URL.revokeObjectURL(url);\r\n                var argsData = {\r\n                    name: afterExport, cancel: false, dataUrl: element.toDataURL('image/png')\r\n                };\r\n                chart.trigger(afterExport, argsData);\r\n                return argsData.dataUrl;\r\n            });\r\n            image_2.src = url;\r\n            return { element: element, blobUrl: url };\r\n        }\r\n    };\r\n    /**\r\n     * To trigger the download element\r\n     *\r\n     * @param fileName\r\n     * @param type\r\n     * @param url\r\n     */\r\n    ExportUtils.prototype.triggerDownload = function (fileName, type, url, isDownload) {\r\n        createElement('a', {\r\n            attrs: {\r\n                'download': fileName + '.' + type.toLocaleLowerCase(),\r\n                'href': url\r\n            }\r\n        }).dispatchEvent(new MouseEvent(isDownload ? 'click' : 'move', {\r\n            view: window,\r\n            bubbles: false,\r\n            cancelable: true\r\n        }));\r\n    };\r\n    /**\r\n     * To get the maximum size value\r\n     *\r\n     * @param controls\r\n     * @param name\r\n     */\r\n    // eslint-disable-next-line max-len\r\n    ExportUtils.prototype.getControlsValue = function (controls, isVertical) {\r\n        var width = 0;\r\n        var height = 0;\r\n        var isCanvas = this.control.enableCanvas;\r\n        var svgObject = new SvgRenderer('').createSvg({\r\n            id: 'Svg_Export_Element',\r\n            width: 200, height: 200\r\n        });\r\n        controls.map(function (control) {\r\n            var svg = control.svgObject.cloneNode(true);\r\n            var groupEle = control.renderer.createGroup({\r\n                style: (isNullOrUndefined(isVertical) || isVertical) ? 'transform: translateY(' + height + 'px)' :\r\n                    'transform: translateX(' + width + 'px)'\r\n            });\r\n            var backgroundColor = svg.childNodes[0] ? svg.childNodes[0].getAttribute('fill') : 'transparent';\r\n            if ((control.theme === 'Tailwind' || control.theme === 'TailwindDark')\r\n                && (backgroundColor === 'rgba(255,255,255, 0.0)' || backgroundColor === 'transparent')) {\r\n                svg.childNodes[0].setAttribute('fill', 'rgba(255,255,255, 1)');\r\n            }\r\n            if (!isCanvas) {\r\n                groupEle.appendChild(svg);\r\n            }\r\n            var top = 0;\r\n            var left = 0;\r\n            if (control.stockLegendModule && control.legendSettings.visible) {\r\n                if (control.legendSettings.position === \"Bottom\" || control.legendSettings.position === \"Top\"\r\n                    || control.legendSettings.position === \"Auto\") {\r\n                    top += control.stockLegendModule.legendBounds.height;\r\n                }\r\n                else if (control.legendSettings.position === \"Left\" || control.legendSettings.position === \"Right\") {\r\n                    left += control.stockLegendModule.legendBounds.width;\r\n                }\r\n            }\r\n            width = (isNullOrUndefined(isVertical) || isVertical) ? Math.max(control.availableSize.width + left, width) :\r\n                width + control.availableSize.width + left;\r\n            height = (isNullOrUndefined(isVertical) || isVertical) ? height + control.availableSize.height + top :\r\n                Math.max(control.availableSize.height + top, height);\r\n            if (!isCanvas) {\r\n                svgObject.appendChild(groupEle);\r\n            }\r\n        });\r\n        if (!isCanvas) {\r\n            svgObject.setAttribute('width', width + '');\r\n            svgObject.setAttribute('height', height + '');\r\n        }\r\n        return {\r\n            'width': width,\r\n            'height': height,\r\n            'svg': svgObject\r\n        };\r\n    };\r\n    ExportUtils.prototype.createCanvas = function () {\r\n        var chart = this.control;\r\n        this.canvasRender(true, chart);\r\n        var canvas = chart.svgObject;\r\n        this.canvasRender(false, chart);\r\n        return canvas;\r\n    };\r\n    /**\r\n     * To convert svg chart into canvas chart to fix export issue in IE\r\n     * We cant export svg to other formats in IE\r\n     *\r\n     * @param enableCanvas\r\n     * @param chart\r\n     * @param enableCanvas\r\n     * @param chart\r\n     */\r\n    ExportUtils.prototype.canvasRender = function (enableCanvas, chart) {\r\n        chart.enableCanvas = enableCanvas;\r\n        chart['preRender']();\r\n        chart['render']();\r\n    };\r\n    // eslint-disable-next-line max-len\r\n    ExportUtils.prototype.exportPdf = function (element, orientation, width, height, isDownload, fileName, header, footer) {\r\n        var document = new PdfDocument();\r\n        var margin = document.pageSettings.margins;\r\n        var pdfDefaultWidth = document.pageSettings.width;\r\n        var pdfDefaultHeight = document.pageSettings.height;\r\n        var imageString = element.toDataURL('image/jpeg').replace('image/jpeg', 'image/octet-stream');\r\n        document.pageSettings.orientation = orientation;\r\n        var exactWidth = (pdfDefaultWidth < width) ? (width + margin.left + margin.right) : pdfDefaultWidth;\r\n        var exactHeight = (pdfDefaultHeight < height) ? (height + margin.top + margin.bottom) : pdfDefaultHeight;\r\n        if (header !== undefined) {\r\n            var font = new PdfStandardFont(1, header.fontSize || 15);\r\n            var pdfHeader = new PdfPageTemplateElement(exactWidth, 40);\r\n            pdfHeader.graphics.drawString(header.content + '', font, null, new PdfSolidBrush(new PdfColor(0, 0, 0)), header.x, header.y, null);\r\n            document.template.top = pdfHeader;\r\n        }\r\n        if (footer !== undefined) {\r\n            var font = new PdfStandardFont(1, footer.fontSize || 15);\r\n            var pdfFooter = new PdfPageTemplateElement(exactWidth, 40);\r\n            pdfFooter.graphics.drawString(footer.content + '', font, null, new PdfSolidBrush(new PdfColor(0, 0, 0)), footer.x, footer.y, null);\r\n            document.template.bottom = pdfFooter;\r\n        }\r\n        document.pageSettings.size = new SizeF(exactWidth, exactHeight);\r\n        imageString = imageString.slice(imageString.indexOf(',') + 1);\r\n        document.pages.add().graphics.drawImage(new PdfBitmap(imageString), 0, 0, width, height);\r\n        if (isDownload) {\r\n            document.save(fileName + '.pdf');\r\n            document.destroy();\r\n        }\r\n    };\r\n    ExportUtils.prototype.doexport = function (type, image, fileName) {\r\n        var images = [];\r\n        var fileType = type || 'JPG';\r\n        images = [image];\r\n        this.exportImage(images, fileName, fileType, image);\r\n    };\r\n    ExportUtils.prototype.exportImage = function (images, fileName, fileType, image) {\r\n        var buffers = [];\r\n        var length = (!(images instanceof HTMLElement)) ? images.length : 0;\r\n        for (var g = 0; g < length; g++) {\r\n            image = images[g];\r\n            image = image.replace(/^data:[a-z]*;,/, '');\r\n            var image1 = image.split(',');\r\n            var byteString = atob(image1[1]);\r\n            var buffer = new ArrayBuffer(byteString.length);\r\n            var intArray = new Uint8Array(buffer);\r\n            for (var i = 0; i < byteString.length; i++) {\r\n                intArray[i] = byteString.charCodeAt(i);\r\n            }\r\n            buffers.push(buffer);\r\n        }\r\n        for (var j = 0; j < buffers.length; j++) {\r\n            var b = new Blob([buffers[j]], { type: 'application/octet-stream' });\r\n            if (Browser.info.name === 'msie') {\r\n                window.navigator.msSaveOrOpenBlob(b, fileName + '.' + fileType.toLocaleLowerCase());\r\n            }\r\n        }\r\n    };\r\n    return ExportUtils;\r\n}());\r\nexport { ExportUtils };\r\n"]},"metadata":{},"sourceType":"module"}